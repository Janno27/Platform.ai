(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[301],{58247:(e,t,a)=>{Promise.resolve().then(a.bind(a,96271))},96271:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tQ});var s=a(95155),r=a(12115),l=a(29602);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});o.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})}).displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter";var c=a(14085),u=a(58237),m=a(35796),x=a(7936),h=a(87364),f=a(54113),p=a(38684),v=a(21773),g=a(40767),j=a(86659),b=a(33473),N=a(46195),y=a(31027);let w=(0,y.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),k=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(N.b,{ref:t,className:(0,l.cn)(w(),a),...r})});k.displayName=N.b.displayName;var S=a(9955),C=a(52582),_=a(20853),A=a(66217);let R=A.bL,T=A.l9,O=A.ZL;A.bm;let D=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(A.hJ,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});D.displayName=A.hJ.displayName;let z=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(O,{children:[(0,s.jsx)(D,{}),(0,s.jsxs)(A.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n,children:[r,(0,s.jsxs)(A.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(g.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});z.displayName=A.UC.displayName;let E=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};E.displayName="DialogHeader";let F=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(A.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});F.displayName=A.hE.displayName;let I=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(A.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});I.displayName=A.VY.displayName;let U=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(C.uB,{ref:t,className:(0,l.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...r})});U.displayName=C.uB.displayName;let V=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,s.jsx)(_.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,s.jsx)(C.uB.Input,{ref:t,className:(0,l.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...r})]})});V.displayName=C.uB.Input.displayName;let L=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(C.uB.List,{ref:t,className:(0,l.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...r})});L.displayName=C.uB.List.displayName;let P=r.forwardRef((e,t)=>(0,s.jsx)(C.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));P.displayName=C.uB.Empty.displayName;let M=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(C.uB.Group,{ref:t,className:(0,l.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...r})});M.displayName=C.uB.Group.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(C.uB.Separator,{ref:t,className:(0,l.cn)("-mx-1 h-px bg-border",a),...r})}).displayName=C.uB.Separator.displayName;let q=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(C.uB.Item,{ref:t,className:(0,l.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...r})});q.displayName=C.uB.Item.displayName;var B=a(51124),$=a(10371);let J=0,W=new Map,K=e=>{if(W.has(e))return;let t=setTimeout(()=>{W.delete(e),G({type:"REMOVE_TOAST",toastId:e})},1e6);W.set(e,t)},Z=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?K(a):e.toasts.forEach(e=>{K(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},H=[],Q={toasts:[]};function G(e){Q=Z(Q,e),H.forEach(e=>{e(Q)})}function Y(e){let{...t}=e,a=(J=(J+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>G({type:"DISMISS_TOAST",toastId:a});return G({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>G({type:"UPDATE_TOAST",toast:{...e,id:a}})}}var X=a(49019);let ee=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-hidden",children:(0,s.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm border-collapse",a),...r})})});ee.displayName="Table";let et=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",a),...r})});et.displayName="TableHeader";let ea=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...r})});ea.displayName="TableBody";let es=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});es.displayName="TableRow";let er=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,l.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});er.displayName="TableHead";let el=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,l.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});el.displayName="TableCell";var en=a(3392);let ei={EUR:"â‚¬",USD:"$",BRL:"R$",GBP:"\xa3",JPY:"\xa5"},eo={transaction:["variation","device_category","transaction_id","item_category2","quantity","products_summary","revenue"],overall:["variation","sessions","users","revenue"]};function ed(e){let{data:t,isLoading:a,currency:r,type:n}=e;if(a)return(0,s.jsx)("div",{children:"Chargement des donn\xe9es..."});if(!t||0===t.length)return(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Aucune donn\xe9e disponible"});let i=Object.values(t.reduce((e,t)=>(t.variation&&!e[t.variation]&&(e[t.variation]=t),e),{})).slice(0,3),o=i.length>0?i:t.slice(0,3),d=eo[n],c=(e,t)=>{if(!e)return"-";if("transaction_id"===t)return e.toString().slice(0,11)+(e.length>11?"...":"");if("products_summary"===t)return e;if("quantity"===t)return parseInt(e).toLocaleString();if(t.toLowerCase().includes("revenue")){let t=ei[r]||r;return"".concat(t).concat(null==e?void 0:e.toLocaleString())}if("variation"===t)return e.toString().toUpperCase();if("number"==typeof e)return e.toLocaleString();if("item_category2"===t){let t=e.toString();return t.length>15?"".concat(t.slice(0,15),"..."):t}return e.toString()},u=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),m=e=>"item_category2"===e?"max-w-[150px] truncate":"";return(0,s.jsx)("div",{className:"relative w-full",children:(0,s.jsxs)(en.F,{className:"w-full rounded-md border",children:[(0,s.jsx)("div",{className:"relative min-w-max",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsx)(es,{children:d.map(e=>(0,s.jsx)(er,{className:(0,l.cn)("whitespace-nowrap px-4","variation"===e&&"font-semibold sticky left-0 bg-background z-10",m(e)),children:u(e)},e))})}),(0,s.jsx)(ea,{children:o.map((e,t)=>(0,s.jsx)(es,{children:d.map(t=>(0,s.jsx)(el,{className:(0,l.cn)("px-4","variation"===t&&"font-medium sticky left-0 bg-background z-10","transaction_id"===t&&"font-mono text-sm",m(t)),title:"item_name_simple"===t?e[t]:void 0,children:c(e[t],t)},t))},t))})]})}),(0,s.jsx)(en.$,{orientation:"horizontal"})]})})}var ec=a(50745);let eu={EUR:"â‚¬",USD:"$",BRL:"R$",GBP:"\xa3",JPY:"\xa5"};function em(e){let{value:t,onValueChange:a}=e;return(0,s.jsxs)(ec.l6,{value:t,onValueChange:a,children:[(0,s.jsx)(ec.bq,{className:"w-[120px]",children:(0,s.jsx)(ec.yv,{placeholder:"Select currency"})}),(0,s.jsx)(ec.gC,{children:Object.entries(eu).map(e=>{let[t,a]=e;return(0,s.jsxs)(ec.eb,{value:t,children:[t," (",a,")"]},t)})})]})}let ex=[{id:"test-1",title:"Homepage Redesign Test",status:"analyzing",icon:u.A},{id:"test-2",title:"Checkout Flow Optimization",status:"analyzing",icon:u.A}];function eh(e){var t,a,u;let{onCollapse:N,onAnalysisStart:y,onProcessStepChange:w,showAnalysis:C,currency:_,onCurrencyChange:A,filters:R,onFilterChange:T}=e,[O,D]=r.useState(null),[z,E]=r.useState(!1),[F,I]=r.useState(!1),[J,W]=r.useState([]),[K,Z]=r.useState({}),[H,Q]=r.useState(!1),[G,ee]=r.useState(!1),[et,ea]=r.useState(!1),[es,er]=r.useState(0),[el,en]=r.useState(null),[ei,eo]=r.useState(!0),[ec,eu]=r.useState("initial"),[eh,ef]=(0,r.useState)(!1),[ep,ev]=(0,r.useState)(!1),[eg,ej]=(0,r.useState)(null),[eb,eN]=(0,r.useState)([]),[ey,ew]=(0,r.useState)(!1),ek=r.useRef(null),eS=r.useRef(null),eC=r.useRef(null),e_=e=>{W(t=>t.filter(t=>t!==e))},eA=()=>{ek.current&&(ek.current.value="",ek.current.click())},eR=(e,t)=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!s)return;if(!s.type.startsWith("image/")){console.error("Please upload an image file");return}let r=new FileReader;r.onload=e=>{var a;let s=null===(a=e.target)||void 0===a?void 0:a.result;Z(e=>({...e,["A"===t?"imageA":"imageB"]:s}))},r.readAsDataURL(s)},eT=e=>{var t,a;"A"===e?null===(t=eS.current)||void 0===t||t.click():null===(a=eC.current)||void 0===a||a.click()},eO=e=>{Z(t=>({...t,["A"===e?"imageA":"imageB"]:void 0}))},eD=async e=>{try{ea(!0),eu("processing"),w("processing"),er(0);let t=setInterval(()=>{er(e=>Math.min(e+10,90))},500),a=await Promise.all(e.map(async e=>{let t=await e.text();try{return JSON.parse(t)}catch(t){throw Error("Le fichier ".concat(e.name," n'est pas un JSON valide"))}})),s={overall_data:a[0],transaction_data:a[1]||[],currency:_,filters:{device_category:[],item_category2:[]}};ev(!1),ej(null);let r=await fetch("http://localhost:8000/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw Error("Erreur HTTP: ".concat(r.status));let l=await r.json();return clearInterval(t),er(100),en(l),eo(!1),eu("analyzed"),w("analyzed"),Y({title:"Data Loaded",description:"Your data has been loaded successfully. You can now aggregate it.",duration:3e3}),l}catch(e){eu("initial"),console.error("Erreur lors de l'upload:",e),Y({variant:"destructive",title:"Erreur",description:e instanceof Error?e.message:"Une erreur est survenue lors de l'analyse"})}finally{ea(!1)}},ez=async()=>{try{var e;if(!(null==el?void 0:null===(e=el.raw_data)||void 0===e?void 0:e.transaction))throw Error("Aucune donn\xe9e de transaction \xe0 agr\xe9ger");let t=await fetch("http://localhost:8000/aggregate-transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(el.raw_data.transaction)});if(!t.ok)throw Error("Erreur HTTP: ".concat(t.status));let a=await t.json();a.success&&(ej({...el,raw_data:{...el.raw_data,transaction:a.data}}),ev(!0),Y({title:"Data Aggregated",description:"Your data has been aggregated successfully",duration:3e3}))}catch(e){Y({variant:"destructive",title:"Erreur",description:e instanceof Error?e.message:"Une erreur est survenue lors de l'agr\xe9gation"})}};return(0,s.jsxs)(n,{className:(0,l.cn)("h-full bg-muted/10 transition-all duration-300","w-full","flex flex-col","overflow-hidden","animate-in slide-in-from-left duration-300"),children:[(0,s.jsx)(S.p,{ref:ek,type:"file",accept:".json,application/json",multiple:!0,className:"hidden",onChange:e=>{let t=Array.from(e.target.files||[]).filter(e=>"application/json"===e.type);t.length>0&&W(e=>[...e,...t])}}),(0,s.jsxs)(i,{className:"relative flex-none",children:[(O||H||C)&&(0,s.jsx)(c.$,{variant:"ghost",size:"sm",className:(0,l.cn)("absolute -right-3 top-1/2 -translate-y-1/2 h-6 w-6 rounded-full p-0","bg-background shadow-sm border border-border","hover:bg-accent hover:text-accent-foreground","transition-colors"),onClick:()=>{ee(!G),N(!G)},children:G?(0,s.jsx)(m.A,{className:"h-4 w-4"}):(0,s.jsx)(x.A,{className:"h-4 w-4"})}),G?(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(o,{className:"text-sm font-semibold",children:O?O.title:H?"New Test":"Test Summary"}),O&&(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border bg-muted/30",children:K.imageB?(0,s.jsx)("img",{src:K.imageB,alt:"Variant B",className:"w-full h-auto object-cover"}):O.visualUrl?(0,s.jsx)("img",{src:O.visualUrl,alt:"Test visual",className:"w-full h-auto object-cover"}):null}),H&&K.imageB&&(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border bg-muted/30",children:(0,s.jsx)("img",{src:K.imageB,alt:"Variant B",className:"w-full h-auto object-cover"})})]}):(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(O||H)&&(0,s.jsxs)(c.$,{variant:"ghost",size:"sm",onClick:()=>{"analyzed"===ec?(eu("initial"),w("initial")):(D(null),Q(!1),Z({}))},className:"h-8 w-8 p-0",children:[(0,s.jsx)(h.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Back to test selection"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o,{className:"text-lg font-semibold tracking-tight",children:O?O.title:H?"New Test":"Test Summary"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:O?"Review your test details and add supplementary data files if needed.":H?"Create a new test by filling in the details and uploading your test data.":"Select a test from your ongoing analyses in the Overview section or upload your own test data in JSON format."})]})]})]}),(0,s.jsx)(d,{className:(0,l.cn)("flex-1","min-h-0","overflow-y-auto","space-y-6",G&&"hidden"),children:C?(0,s.jsx)(n,{children:(0,s.jsx)(d,{className:"p-6",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Test Information"}),(0,s.jsx)("div",{className:"grid gap-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium mb-1",children:"Hypothesis"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:K.hypothesis||"No hypothesis provided"})]})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Variations"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Control"}),K.imageA?(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border",children:(0,s.jsx)("img",{src:K.imageA,alt:"Control Version",className:"w-full h-auto"})}):(0,s.jsx)("div",{className:"rounded-lg border p-4 text-sm text-muted-foreground",children:"No control image provided"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Variant"}),K.imageB?(0,s.jsx)("div",{className:"rounded-lg overflow-hidden border",children:(0,s.jsx)("img",{src:K.imageB,alt:"Variant Version",className:"w-full h-auto"})}):(0,s.jsx)("div",{className:"rounded-lg border p-4 text-sm text-muted-foreground",children:"No variant image provided"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Key Metrics"}),el?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Conversion Rate"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:"+12.5%"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"vs Control"})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Revenue Impact"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:"+â‚¬5,234"}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Projected Monthly"})]})]}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No analysis data available"})]})]})})}):(0,s.jsx)(s.Fragment,{children:O||H?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:(0,l.cn)("space-y-4 transition-all duration-300","analyzed"===ec?"opacity-100":"opacity-0 hidden"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-sm font-medium",children:"Data Overview"}),(0,s.jsx)(em,{value:_,onValueChange:A})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsxs)("div",{className:"flex gap-4",children:["analyzed"===ec&&!ep&&(0,s.jsx)(c.$,{onClick:ez,variant:"outline",children:"Aggregate Data"}),"analyzed"===ec&&(0,s.jsxs)(c.$,{onClick:()=>{var e,t;let a=ep?null==eg?void 0:null===(e=eg.raw_data)||void 0===e?void 0:e.transaction:null==el?void 0:null===(t=el.raw_data)||void 0===t?void 0:t.transaction;if(!a||0===a.length)return;let s=Math.floor(Math.random()*a.length);eN([a[s]]),ew(!0)},variant:"outline",size:"sm",children:[(0,s.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Check Samples"]})]})}),ey&&eb.length>0&&(0,s.jsxs)("div",{className:"mb-6 space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsx)("h5",{className:"text-sm font-medium",children:"Random Sample"}),(0,s.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>ew(!1),children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})]}),(0,s.jsx)("div",{className:"grid gap-3",children:eb.map((e,t)=>(0,s.jsxs)("div",{className:"p-4 rounded-md bg-muted/50 space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Transaction ID"}),(0,s.jsx)("div",{className:"font-mono text-sm",children:e.transaction_id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Variation"}),(0,s.jsx)("div",{className:"text-sm",children:e.variation})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Revenue"}),(0,s.jsxs)("div",{className:"text-sm font-medium",children:[e.revenue," ",_]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Quantity"}),(0,s.jsx)("div",{className:"text-sm",children:e.quantity})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground block mb-1",children:"Category"}),(0,s.jsx)("div",{className:"text-sm max-w-[150px] truncate",title:e.item_category2,children:e.item_category2})]})]},t))})]}),(0,s.jsx)(ed,{data:ep?null==eg?void 0:null===(t=eg.raw_data)||void 0===t?void 0:t.transaction:(null==el?void 0:null===(a=el.raw_data)||void 0===a?void 0:a.transaction)||[],isLoading:et,currency:_,type:"transaction"})]}),(0,s.jsx)("div",{children:(0,s.jsx)(ed,{data:(null==el?void 0:null===(u=el.raw_data)||void 0===u?void 0:u.overall)||[],isLoading:et,currency:_,type:"overall"})})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 mt-8",children:[(0,s.jsx)(c.$,{variant:"outline",onClick:()=>{ef(!1),eu("initial"),w("initial"),en(null),W([]),Z({}),Q(!0),ev(!1),ej(null)},children:"Reset"}),(0,s.jsx)(c.$,{onClick:()=>{ef(!0),y({title:K.title,hypothesis:K.hypothesis,imageA:K.imageA,imageB:K.imageB,analysisData:ep?eg:el,currency:_})},disabled:!ep||!_,title:_?ep?"":"Please aggregate your data before running the analysis":"Please select a currency before running the analysis",children:"Run Analysis"})]})]}),(0,s.jsx)(X.Nt,{open:"analyzed"!==ec,onOpenChange:e=>{e||"initial"!==ec||eD(Array.from(J))},children:(0,s.jsxs)(X.Ke,{className:(0,l.cn)("space-y-6 transition-all duration-300","analyzed"===ec?"hidden":"opacity-100"),children:[(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{htmlFor:"title",children:"Test Name"}),(0,s.jsx)(S.p,{id:"title",value:K.title||"",onChange:e=>Z(t=>({...t,title:e.target.value})),placeholder:"Enter test name..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{htmlFor:"hypothesis",children:"Hypothesis"}),(0,s.jsx)($.T,{id:"hypothesis",value:K.hypothesis||"",onChange:e=>Z(t=>({...t,hypothesis:e.target.value})),placeholder:"Enter your test hypothesis...",className:"min-h-[100px]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{htmlFor:"context",children:"Context"}),(0,s.jsx)($.T,{id:"context",value:K.context||"",onChange:e=>Z(t=>({...t,context:e.target.value})),placeholder:"Describe the test context...",className:"min-h-[100px]"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{children:"Version A (Control)"}),(0,s.jsxs)("div",{className:"mt-2 border-2 border-dashed border-muted rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors relative group",onClick:()=>eT("A"),children:[(0,s.jsx)(S.p,{ref:eS,type:"file",accept:"image/*",className:"hidden",onChange:e=>eR(e,"A")}),K.imageA?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:K.imageA,alt:"Version A",className:"max-h-[200px] mx-auto"}),(0,s.jsx)(c.$,{variant:"secondary",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:e=>{e.stopPropagation(),eO("A")},children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})]}):(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsx)(p.A,{className:"w-8 h-8 mx-auto text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground mt-2 block",children:"Upload Version A"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(k,{children:"Version B (Variant)"}),(0,s.jsxs)("div",{className:"mt-2 border-2 border-dashed border-muted rounded-lg p-4 text-center cursor-pointer hover:border-primary/50 transition-colors relative group",onClick:()=>eT("B"),children:[(0,s.jsx)(S.p,{ref:eC,type:"file",accept:"image/*",className:"hidden",onChange:e=>eR(e,"B")}),K.imageB?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:K.imageB,alt:"Version B",className:"max-h-[200px] mx-auto"}),(0,s.jsx)(c.$,{variant:"secondary",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:e=>{e.stopPropagation(),eO("B")},children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})]}):(0,s.jsxs)("div",{className:"py-8",children:[(0,s.jsx)(p.A,{className:"w-8 h-8 mx-auto text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground mt-2 block",children:"Upload Version B"})]})]})]})]})]})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("span",{className:"w-full border-t"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,s.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"and"})})]}),el?(0,s.jsxs)(c.$,{variant:"outline",className:"w-full flex items-center justify-center gap-2",onClick:eA,children:[(0,s.jsx)(b.A,{className:"h-4 w-4"}),"Add Files"]}):(0,s.jsxs)("div",{onClick:eA,onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault();let t=Array.from(e.dataTransfer.files).filter(e=>"application/json"===e.type);W(e=>[...e,...t])},className:(0,l.cn)("border-2 border-dashed border-muted rounded-lg flex flex-col gap-2 p-6 items-center cursor-pointer hover:border-primary/50 hover:bg-muted/50 transition-colors",F&&"opacity-50 cursor-wait"),children:[(0,s.jsx)(j.A,{className:"w-8 h-8 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:F?"Uploading...":"Click or drag and drop to add files"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Accepts multiple JSON files"})]}),J.length>0&&(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,s.jsx)(k,{className:"text-sm font-medium",children:"Selected Files"}),(0,s.jsx)("div",{className:"space-y-2",children:J.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{className:"w-4 h-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm",children:e.name}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",Math.round(e.size/1024),"KB)"]})]}),(0,s.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>e_(e),className:"h-8 w-8 p-0",children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})]},t))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4",children:[(0,s.jsx)(c.$,{variant:"outline",onClick:()=>{Q(!1),Z({})},children:"Cancel"}),(0,s.jsx)(c.$,{disabled:0===J.length,onClick:async()=>{if(J.length>0){I(!0);try{await eD(Array.from(J))}finally{I(!1)}}},children:"processing"===ec?"Processing...":"Process Data"})]})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)(B.AM,{open:z,onOpenChange:E,children:[(0,s.jsx)(B.Wv,{asChild:!0,children:(0,s.jsxs)(c.$,{variant:"outline",className:"w-full justify-center",children:[(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Select from Overview"]})}),(0,s.jsx)(B.hl,{className:"p-0",side:"right",align:"start",children:(0,s.jsxs)(U,{children:[(0,s.jsx)(V,{placeholder:"Search tests..."}),(0,s.jsxs)(L,{children:[(0,s.jsx)(P,{children:"No analyzing tests found."}),(0,s.jsx)(M,{heading:"Analyzing Tests",children:ex.map(e=>(0,s.jsxs)(q,{value:e.title,onSelect:()=>{D({id:e.id,title:e.title,hypothesis:"Test hypothesis...",context:"Test context..."}),E(!1)},children:[(0,s.jsx)(e.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{children:e.title})]},e.id))})]})]})})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,s.jsx)("span",{className:"w-full border-t"})}),(0,s.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,s.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"or"})})]}),(0,s.jsxs)(c.$,{variant:"outline",className:"w-full justify-center",onClick:()=>{Q(!0),I(!1)},children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Upload Test Data"]})]})})})]})}function ef(e){let{onAnalysisStart:t,onProcessStepChange:a,showAnalysis:n,currency:i,onCurrencyChange:o,filters:d,onFilterChange:c,onCollapse:u}=e,[m,x]=(0,r.useState)(()=>{{let e=localStorage.getItem("summaryCollapsed");return!!e&&JSON.parse(e)}});return(0,r.useEffect)(()=>{localStorage.setItem("summaryCollapsed",JSON.stringify(m)),u(m)},[m,u]),(0,s.jsxs)("div",{className:(0,l.cn)("flex flex-col h-full","overflow-hidden"),children:[(0,s.jsx)("div",{className:"p-6 flex-none",children:(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"A/B Test Analyzer"})}),(0,s.jsx)("div",{className:(0,l.cn)("flex-1","min-h-0","px-6 pb-6","overflow-hidden"),children:(0,s.jsx)(eh,{onCollapse:u,onAnalysisStart:t,onProcessStepChange:a,showAnalysis:n,currency:i,onCurrencyChange:o,filters:d,onFilterChange:c})})]})}var ep=a(58629);let ev=ep.bL,eg=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ep.B8,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});eg.displayName=ep.B8.displayName;let ej=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ep.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});ej.displayName=ep.l9.displayName;let eb=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ep.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});eb.displayName=ep.UC.displayName;var eN=a(12413);let ey=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(eN.bL,{className:(0,l.cn)("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...r,ref:t,children:(0,s.jsx)(eN.zi,{className:(0,l.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});ey.displayName=eN.bL.displayName;var ew=a(78579),ek=a(44857),eS=a(51719),eC=a(25488),e_=a(9246);function eA(e){var t;let{data:a}=e,[n,i]=r.useState("overall"),[o,d]=r.useState({}),[u,m]=r.useState(!1),[x,h]=r.useState(!1),[f,p]=r.useState(null),[v,g]=r.useState(!1),j=async()=>{if("transaction"===n){if(v){h(!0),await new Promise(e=>setTimeout(e,300)),p(null),g(!1),h(!1);return}try{var e,t,s,r;m(!0),console.log("Data being sent:",null==a?void 0:null===(t=a.analysisData)||void 0===t?void 0:null===(e=t.raw_data)||void 0===e?void 0:e.transaction);let l=await fetch("http://localhost:8000/aggregate-transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((null==a?void 0:null===(r=a.analysisData)||void 0===r?void 0:null===(s=r.raw_data)||void 0===s?void 0:s.transaction)||[])});if(!l.ok){let e=await l.json();throw Error(e.detail||"Failed to aggregate data")}let n=await l.json();if(console.log("Received result:",n),n.success&&Array.isArray(n.data))p(n.data),g(!0);else throw Error("Invalid response format")}catch(e){console.error("Error aggregating data:",e)}finally{m(!1)}}},b=e=>null==e?"-":"string"==typeof e?e.length>30?"".concat(e.slice(0,30),"..."):e:"number"==typeof e?e.toLocaleString():String(e),N=e=>{d(t=>({...t,[e]:!t[e]}))},y=r.useMemo(()=>{var e;return(null==a?void 0:null===(e=a.analysisData)||void 0===e?void 0:e.raw_data)?"transaction"===n&&v&&f?f:a.analysisData.raw_data[n]||[]:[]},[a,n,v,f]),w=y[0]?v?["transaction_id","variation","device_category","item_category2","item_name_simple","quantity","revenue"].filter(e=>Object.keys(y[0]).includes(e)):Object.keys(y[0]):[],S=()=>(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"h-8 flex items-center space-x-4 mb-6",children:[(0,s.jsx)(eC.E,{className:"h-6 w-32"}),(0,s.jsx)(eC.E,{className:"h-6 w-24"})]}),Array.from({length:8}).map((e,t)=>(0,s.jsx)("div",{className:"flex space-x-4",children:Array.from({length:6}).map((e,t)=>(0,s.jsx)(eC.E,{className:(0,l.cn)("h-6",0===t?"w-28":"w-24")},t))},t))]});return(0,s.jsx)(e_.TooltipProvider,{delayDuration:100,children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b p-4 bg-background z-30 shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(ey,{id:"dataset-switch",checked:"transaction"===n,onCheckedChange:e=>{let t=e?"transaction":"overall";h(!0),p(null),g(!1),setTimeout(()=>{i(t),h(!1)},300)},disabled:!(null==a?void 0:null===(t=a.analysisData)||void 0===t?void 0:t.raw_data)||x}),(0,s.jsx)(k,{htmlFor:"dataset-switch",children:"transaction"===n?"Transaction Data":"Overall Data"})]}),"transaction"===n&&(0,s.jsxs)(c.$,{variant:"outline",size:"sm",onClick:j,disabled:u||x,className:"ml-4",children:[(0,s.jsx)(ew.A,{className:"mr-2 h-4 w-4"}),u||x?"Loading...":v?"Show Raw":"Aggregate Data"]})]}),(0,s.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{var e,t;let s=null==a?void 0:null===(t=a.analysisData)||void 0===t?void 0:null===(e=t.raw_data)||void 0===e?void 0:e[n];s&&function(e,t){let a=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),r=URL.createObjectURL(a);s.setAttribute("href",r),s.setAttribute("download",t),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}(function(e){if(!e||!e.length)return"";let t=Object.keys(e[0]),a=e.map(e=>t.map(t=>{let a=e[t];return"string"==typeof a&&a.includes(",")?'"'.concat(a,'"'):a}).join(","));return[t.join(","),...a].join("\n")}(s),"".concat(n,"_data.csv"))},disabled:x||u,children:[(0,s.jsx)(ek.A,{className:"mr-2 h-4 w-4"}),"Export"]})]}),(0,s.jsx)("div",{className:"flex-1 relative overflow-hidden",children:x?S():(0,s.jsx)("div",{className:"absolute inset-0 overflow-auto",children:(0,s.jsx)("div",{className:"inline-block min-w-full align-middle",children:(0,s.jsx)("div",{className:"relative",children:u||x?S():(0,s.jsxs)(ee,{className:"w-full",children:[(0,s.jsx)(et,{children:(0,s.jsx)(es,{className:"sticky top-0 z-20 bg-background",children:w.map(e=>(0,s.jsx)(er,{className:(0,l.cn)("whitespace-nowrap bg-background border-b text-center",o[e]&&"w-12 !p-0"),style:{position:"sticky",top:0},children:(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(c.$,{variant:"ghost",size:"sm",className:(0,l.cn)("h-8 p-1 hover:bg-muted",o[e]&&"w-full h-full rounded-none"),onClick:()=>N(e),children:[(0,s.jsx)(eS.A,{className:(0,l.cn)("h-4 w-4 shrink-0 transition-transform",o[e]&&"-rotate-90")}),!o[e]&&(0,s.jsx)("span",{className:"ml-2",children:e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")})]})})},e))})}),(0,s.jsx)(ea,{children:y.map((e,t)=>(0,s.jsx)(es,{children:w.map(t=>{var a;return(0,s.jsx)(el,{className:(0,l.cn)("transition-all text-center px-4 py-2",o[t]&&"w-12 !p-2"),children:(0,s.jsx)("div",{className:(0,l.cn)("transition-all",o[t]?"opacity-0":"opacity-100"),children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{asChild:!0,children:(0,s.jsx)("span",{className:"cursor-help inline-block px-2 py-1 hover:bg-muted/50 rounded",children:b(e[t])})}),(0,s.jsx)(e_.ZI,{side:"top",align:"center",className:"max-w-[300px] break-words bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md",children:null===(a=e[t])||void 0===a?void 0:a.toString()})]})})},t)})},t))})]})})})})})]})})}var eR=a(59136),eT=a(48617),eO=a(86878);function eD(e){let{title:t,description:a,methodUsed:r,showCalculationDetails:n=!0,confidenceInterval:i,confidenceData:o}=e,d=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"count";if(void 0===e)return"-";let s=Number(e);if(isNaN(s))return"-";let r=Number(s.toFixed(2));switch(a){case"count":if("currency"===t)return"â‚¬".concat(r.toLocaleString());return r.toLocaleString();case"total":return r.toLocaleString();case"rate":switch(t){case"currency":return"â‚¬".concat(r.toLocaleString());case"percentage":return"".concat(r,"%");case"quantity":return r.toFixed(2);default:return r.toLocaleString()}}};return(0,s.jsx)("div",{className:"w-[380px] text-left",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2 pb-3 border-b border-border",children:[(0,s.jsx)(eO.A,{className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground",children:"Statistical Test"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:t}),i&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground/80 flex items-baseline gap-1",children:[(0,s.jsxs)("span",{className:"shrink-0 text-muted-foreground",children:["Confidence Interval (",i.metric,"):"]}),(0,s.jsxs)("span",{className:"font-medium text-muted-foreground/60",children:["[",d(i.lower),"%, ",d(i.upper),"%]"]})]}),o&&(0,s.jsxs)("p",{className:"text-xs flex items-baseline gap-1",children:[(0,s.jsx)("span",{className:"shrink-0 text-muted-foreground",children:"Statistical Confidence:"}),(0,s.jsxs)("span",{className:(0,l.cn)("font-medium",o.level.color),children:[o.value.toFixed(1),"%"]}),(0,s.jsxs)("span",{className:"text-muted-foreground/60",children:["- ",o.level.label]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"font-medium text-foreground block text-sm",children:"Method Used"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:r||a})]}),(null==o?void 0:o.details)&&(0,s.jsxs)("div",{className:"space-y-2 bg-muted/50 p-3 rounded-md",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground font-medium",children:"Calculation Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Control"}),(0,s.jsxs)("div",{className:"space-y-1 mt-1",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Count:"}),(0,s.jsx)("span",{className:"font-medium text-primary/90",children:d(o.details.control.count,o.details.control.unit,"count")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total:"}),(0,s.jsx)("span",{className:"font-medium text-primary/90",children:d(o.details.control.total,void 0,"total")})]}),(0,s.jsxs)("div",{className:"flex justify-between border-t border-border/50 pt-1 mt-1",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Rate:"}),(0,s.jsx)("span",{className:"font-medium text-primary/90",children:d(o.details.control.rate,o.details.control.unit,"rate")})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Variation"}),(0,s.jsxs)("div",{className:"space-y-1 mt-1",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Count:"}),(0,s.jsx)("span",{className:"font-medium text-primary/90",children:d(o.details.variation.count,o.details.variation.unit,"count")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total:"}),(0,s.jsx)("span",{className:"font-medium text-primary/90",children:d(o.details.variation.total,void 0,"total")})]}),(0,s.jsxs)("div",{className:"flex justify-between border-t border-border/50 pt-1 mt-1",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Rate:"}),(0,s.jsx)("span",{className:"font-medium text-primary/90",children:d(o.details.variation.rate,o.details.variation.unit,"rate")})]})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("span",{className:"font-medium text-foreground block text-sm",children:"Confidence Levels"}),(0,s.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-2.5 w-2.5 rounded-full bg-green-500 shrink-0"}),(0,s.jsxs)("div",{className:"flex gap-1.5",children:[(0,s.jsx)("span",{className:"text-foreground shrink-0",children:"â‰¥ 95%"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:": Statistically Significant"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-2.5 w-2.5 rounded-full bg-yellow-500 shrink-0"}),(0,s.jsxs)("div",{className:"flex gap-1.5",children:[(0,s.jsx)("span",{className:"text-foreground shrink-0",children:"â‰¥ 90%"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:": Partially Significant"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-2.5 w-2.5 rounded-full bg-muted shrink-0"}),(0,s.jsxs)("div",{className:"flex gap-1.5",children:[(0,s.jsx)("span",{className:"text-foreground shrink-0",children:"< 90%"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:": Not Significant"})]})]})]})]})]})]})})}let ez={users:{test:"Student's t-test",description:"Compares the mean number of users between variations. Assumes normal distribution due to large sample size (Central Limit Theorem).",implementation:"stats.ttest_ind() with equal_var=False (Welch's t-test)"},add_to_cart_rate:{test:"Fisher's Exact Test",description:"Compares add to cart rates between variations. Ideal for binary outcomes (added vs not added).",implementation:"stats.fisher_exact() for precise probability calculation"},transaction_rate:{test:"Fisher's Exact Test",description:"Compares conversion rates between variations. Ideal for binary outcomes (converted vs not converted).",implementation:"stats.fisher_exact() for precise probability calculation"},total_revenue:{test:"Mann-Whitney U Test",description:"Non-parametric test comparing revenue distributions. Robust against typical revenue data skewness.",implementation:"stats.mannwhitneyu() with alternative='two-sided'"}},eE=e=>e>=95?{label:"Statistically Significant",color:"text-green-500"}:e>=90?{label:"Partially Significant",color:"text-yellow-500"}:{label:"Not Significant",color:"text-muted-foreground"};function eF(e){var t,a,n,i,o,d,c,u;let{data:m,isLoading:x}=e,[h,f]=r.useState(!1),[p,v]=r.useState(null),g=(e,t)=>void 0===e?"-":"uplift"===t?"".concat(e>0?"+":"").concat(e.toFixed(2),"%"):"rate"===t||"confidence"===t?"".concat(e.toFixed(2),"%"):"revenue"===t?"â‚¬".concat(e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})):e.toLocaleString(),j=e=>e>0?"text-green-500":"text-red-500",b=r.useCallback(e=>{let t=[...e].sort((e,t)=>e-t),a=t[Math.floor(.25*t.length)],s=t[Math.floor(.75*t.length)],r=s-a,l=a-1.5*r,n=s+1.5*r;return e.map(e=>e<l||e>n)},[]),N=r.useCallback((e,t)=>{if(!(null==e?void 0:e.data))return null;let a={...e};if(!t)return a;let s={};Object.values(a.data).forEach(e=>{Object.entries(e).forEach(e=>{let[t,a]=e;s[t]||(s[t]=[]),void 0!==a.value&&s[t].push(a.value)})});let r={};return Object.entries(s).forEach(e=>{let[t,a]=e;r[t]=b(a)}),Object.entries(a.data).forEach(e=>{let[t,a]=e;Object.entries(a).forEach(e=>{let[t,l]=e,n=s[t].indexOf(l.value);r[t][n]&&(a[t]={...l,uplift:0,confidence:0})})}),a},[b]);r.useEffect(()=>{v(N(m,h))},[m,h,N]);let y=r.useMemo(()=>{if(!(null==m?void 0:m.data))return null;let e={};return Object.entries(N(m,!0).data).forEach(t=>{let[a,s]=t;e[a]={total:Object.keys(s).length,outliers:Object.values(s).filter(e=>0===e.confidence).length}}),e},[m,N]);if(x)return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"w-[300px] h-10 bg-muted animate-pulse rounded-md"}),(0,s.jsx)("div",{className:"w-[200px] h-10 bg-muted animate-pulse rounded-md"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-12 bg-muted animate-pulse rounded-md"}),(0,s.jsx)("div",{className:"h-12 bg-muted animate-pulse rounded-md"}),(0,s.jsx)("div",{className:"h-12 bg-muted animate-pulse rounded-md"})]})]});if(!(null==m?void 0:m.success)||!(null==m?void 0:m.data))return(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No data available"});let w={[m.control]:{users:{value:(null===(a=m.data[Object.keys(m.data)[0]])||void 0===a?void 0:null===(t=a.users)||void 0===t?void 0:t.control_value)||0,uplift:0,confidence:0},add_to_cart_rate:{value:(null===(i=m.data[Object.keys(m.data)[0]])||void 0===i?void 0:null===(n=i.add_to_cart_rate)||void 0===n?void 0:n.control_value)||0,uplift:0,confidence:0},transaction_rate:{value:(null===(d=m.data[Object.keys(m.data)[0]])||void 0===d?void 0:null===(o=d.transaction_rate)||void 0===o?void 0:o.control_value)||0,uplift:0,confidence:0},total_revenue:{value:(null===(u=m.data[Object.keys(m.data)[0]])||void 0===u?void 0:null===(c=u.total_revenue)||void 0===c?void 0:c.control_value)||0,uplift:0,confidence:0}},...m.data},S=[{key:"users",label:"Users",type:"number",showStats:!1},{key:"add_to_cart_rate",label:"Add to Cart Rate",type:"rate",showStats:!0},{key:"transaction_rate",label:"Transaction Rate",type:"rate",showStats:!0},{key:"total_revenue",label:"Total Revenue",type:"currency",showStats:!0}],C=(e,t,a)=>{if(void 0===t)return!1;let s=Object.values(a).map(t=>{var a;return null===(a=t[e])||void 0===a?void 0:a.value}).filter(e=>void 0!==e);return s.length>0&&Math.max(...s)===t},_=(e,t)=>{var a,r,l,n,i,o,d,c,u,m,x,h,f,p,v,g,j,b,N;return(0,s.jsx)(eD,{title:ez[e].test,description:ez[e].description,methodUsed:ez[e].implementation,showCalculationDetails:!0,confidenceInterval:{lower:(null===(a=t.confidence_interval)||void 0===a?void 0:a.lower)||0,upper:(null===(r=t.confidence_interval)||void 0===r?void 0:r.upper)||0,metric:(null===(l=S.find(t=>t.key===e))||void 0===l?void 0:l.label)||""},confidenceData:{value:t.confidence||0,level:eE(t.confidence||0),details:{variation:{count:(null===(i=t.details)||void 0===i?void 0:null===(n=i.variation)||void 0===n?void 0:n.count)||0,total:(null===(d=t.details)||void 0===d?void 0:null===(o=d.variation)||void 0===o?void 0:o.total)||0,rate:(null===(u=t.details)||void 0===u?void 0:null===(c=u.variation)||void 0===c?void 0:c.rate)||0,unit:(null===(x=t.details)||void 0===x?void 0:null===(m=x.variation)||void 0===m?void 0:m.unit)||""},control:{count:(null===(f=t.details)||void 0===f?void 0:null===(h=f.control)||void 0===h?void 0:h.count)||0,total:(null===(v=t.details)||void 0===v?void 0:null===(p=v.control)||void 0===p?void 0:p.total)||0,rate:(null===(j=t.details)||void 0===j?void 0:null===(g=j.control)||void 0===g?void 0:g.rate)||0,unit:(null===(N=t.details)||void 0===N?void 0:null===(b=N.control)||void 0===b?void 0:b.unit)||""}}}})};return(0,s.jsxs)("div",{className:"space-y-4 px-6",children:[(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{delayDuration:0,children:[(0,s.jsx)(e_.k$,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center gap-1 cursor-help text-muted-foreground hover:text-muted-foreground/80 transition-colors",children:[(0,s.jsx)(eT.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"text-sm",children:"Outliers Statistics"})]})}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-0 bg-popover border-border shadow-lg",sideOffset:5,children:(0,s.jsxs)("div",{className:"w-[350px] max-w-[90vw] p-4 text-left",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 pb-3 mb-3 border-b border-border",children:[(0,s.jsx)(eR.A,{className:"h-5 w-5 text-primary shrink-0"}),(0,s.jsx)("h4",{className:"font-semibold text-foreground",children:"Outliers Statistics"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[y&&Object.entries(y).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"font-medium text-foreground",children:t}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.outliers," outliers out of ",a.total," metrics",(0,s.jsxs)("span",{className:"ml-1 text-foreground",children:["(",(a.outliers/a.total*100).toFixed(1),"%)"]})]})]},t)}),(0,s.jsx)("div",{className:"pt-3 mt-1 border-t border-border",children:(0,s.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Outliers are detected using the Interquartile Range (IQR) method. A value is considered an outlier if it falls outside [Q1 - 1.5*IQR, Q3 + 1.5*IQR]."})})]})]})})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(ey,{id:"remove-outliers",checked:h,onCheckedChange:f}),(0,s.jsx)(k,{htmlFor:"remove-outliers",children:"Exclude outliers"})]})]})}),(0,s.jsx)("div",{className:"rounded-lg border bg-card overflow-hidden",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-12 bg-muted/50",children:"Variation"}),S.map(e=>(0,s.jsx)(er,{className:"h-12 text-right bg-muted/50",children:e.label},e.key))]})}),(0,s.jsx)(ea,{children:Object.entries(w).map((e,t)=>{let[a,r]=e;return(0,s.jsxs)(es,{className:(0,l.cn)("h-[72px] hover:bg-muted/50 transition-colors",0===t&&"bg-muted/30"),children:[(0,s.jsx)(el,{className:"font-medium",children:a}),S.map(e=>{var t,n,i,o,d;return(0,s.jsx)(el,{className:"text-right",children:(0,s.jsx)("div",{className:"space-y-1",children:r[e.key]?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,l.cn)("tabular-nums",C(e.key,null===(t=r[e.key])||void 0===t?void 0:t.value,w)&&"font-semibold"),children:g(null===(n=r[e.key])||void 0===n?void 0:n.value,e.type)}),a!==m.control&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:(0,l.cn)("text-sm",j((null===(i=r[e.key])||void 0===i?void 0:i.uplift)||0)),children:g(null===(o=r[e.key])||void 0===o?void 0:o.uplift,"uplift")}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground cursor-help",children:(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsxs)(e_.k$,{children:["Stats : ",g(null===(d=r[e.key])||void 0===d?void 0:d.confidence,"confidence")]}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-4 bg-popover border-border shadow-lg",sideOffset:5,children:_(e.key,r[e.key])})]})})})]})]}):(0,s.jsx)("div",{className:"text-muted-foreground",children:"-"})})},e.key)})]},a)})})]})})]})}var eI=a(11864),eU=a(66261),eV=a(16099),eL=a(13950),eP=a(14807),eM=a(60719),eq=a(51508),eB=a(75483),e$=a(89507),eJ=a(56179),eW=a(58581),eK=a(394),eZ=a(15255),eH=a(12800),eQ=a(66963),eG=a(27112),eY=a(86354),eX=a(87162),e0=a(16161),e1=a(94973),e2=a(85047),e5=a(99053),e4=a(61594);let e3=(0,y.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),e6=r.forwardRef((e,t)=>{let{className:a,variant:r,...n}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(e3({variant:r}),a),...n})});e6.displayName="Alert",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})}).displayName="AlertTitle";let e8=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a),...r})});e8.displayName="AlertDescription";var e9=a(39286);function e7(e){let{onSave:t}=e,[a,n]=r.useState(!1),[i,o]=r.useState([{min:0,max:2e3},{min:2001,max:3e3},{min:3001,max:4e3},{min:4001,max:5e3},{min:5001,max:1/0}]),[d,u]=r.useState({}),m=e=>{let t={},a=!0;return e.forEach((s,r)=>{s.max<=s.min&&(t["range-".concat(r)]="Max value must be greater than min value",a=!1),r>0&&s.min!==e[r-1].max+1&&(t["range-".concat(r)]="Ranges must be continuous",a=!1)}),u(t),a},x=(e,t)=>{let a=parseInt(t);if(isNaN(a))return;let s=[...i];s[e]={...s[e],max:a},e<s.length-1&&(s[e+1]={...s[e+1],min:a+1}),o(s),m(s)};return(0,s.jsxs)(R,{open:a,onOpenChange:n,children:[(0,s.jsx)(T,{asChild:!0,children:(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,s.jsx)(e2.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(z,{className:"sm:max-w-[600px]",children:[(0,s.jsxs)(E,{children:[(0,s.jsx)(F,{children:"Revenue Range Configuration"}),(0,s.jsx)(I,{className:"text-muted-foreground",children:"Configure the revenue ranges for analysis. Ranges must be continuous and non-overlapping."})]}),(0,s.jsx)(en.F,{className:"max-h-[400px] pr-4",children:(0,s.jsx)("div",{className:"space-y-6 py-4",children:i.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:(0,l.cn)("flex items-center gap-3 p-4 rounded-lg border bg-card",d["range-".concat(t)]&&"border-destructive"),children:[(0,s.jsxs)(e9.E,{variant:"outline",className:"h-7 px-3 shrink-0",children:["Range ",t+1]}),(0,s.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(k,{className:"text-xs text-muted-foreground mb-1.5",children:"Min Value (â‚¬)"}),(0,s.jsx)(S.p,{type:"number",value:e.min,disabled:!0,className:"bg-muted/50"})]}),(0,s.jsx)(e5.A,{className:"h-4 w-4 text-muted-foreground mt-6"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(k,{className:"text-xs text-muted-foreground mb-1.5",children:"Max Value (â‚¬)"}),(0,s.jsx)(S.p,{type:"number",value:e.max===1/0?"âˆž":e.max,onChange:e=>x(t,e.target.value),disabled:t===i.length-1,className:(0,l.cn)(t===i.length-1&&"bg-muted/50",d["range-".concat(t)]&&"border-destructive")})]})]})]}),d["range-".concat(t)]&&(0,s.jsxs)(e6,{variant:"destructive",className:"mt-2",children:[(0,s.jsx)(e4.A,{className:"h-4 w-4"}),(0,s.jsx)(e8,{children:d["range-".concat(t)]})]})]},t))})}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,s.jsx)(c.$,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),(0,s.jsx)(c.$,{onClick:()=>{m(i)&&(t(i),n(!1))},children:"Save changes"})]})]})]})}var te=a(65494);let tt={height:400,padding:{top:20,right:20,bottom:20,left:20},colors:{primary:te.D6.primary,secondary:te.D6.secondary,accent:te.D6.accent,yellow:te.D6.yellow,blue:te.D6.blue,control:te.D6.control}};function ta(){return(0,s.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"w-48 h-6 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"w-8 h-8 bg-muted animate-pulse rounded"})]}),(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-12 bg-muted/50",children:(0,s.jsx)("div",{className:"w-32 h-4 bg-muted animate-pulse rounded"})}),[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(er,{className:"h-12 text-right bg-muted/50",children:(0,s.jsx)("div",{className:"w-24 h-4 bg-muted animate-pulse rounded ml-auto"})},t))]})}),(0,s.jsx)(ea,{children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsxs)(es,{className:"h-[72px]",children:[(0,s.jsx)(el,{children:(0,s.jsx)("div",{className:"w-40 h-4 bg-muted animate-pulse rounded"})}),[void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(el,{className:"text-right",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"w-20 h-4 bg-muted animate-pulse rounded ml-auto"}),t>0&&(0,s.jsx)("div",{className:"w-16 h-3 bg-muted animate-pulse rounded ml-auto"})]})},t))]},t))})]})})]})}let ts=e=>{if(e.toLowerCase().includes("control"))return"Control";for(let t of[/\[.*\]\s*Variation\s*(\d+)/,/var(\d+)/i,/variation\s*(\d+)/i,/var_(\d+)/i,/v(\d+)/i]){let a=e.match(t);if(a)return"Var ".concat(a[1])}let t=e.match(/(\d+)/);return t?"Var ".concat(t[1]):e};function tr(e){let{data:t,control:a,isLoading:i=!1,showChart:o=!1,virtualTable:u=[]}=e,[m,x]=r.useState([]),[h,f]=r.useState("revenue"),[p,v]=r.useState("combo"),[g,j]=r.useState(!1),b=r.useRef(null),[N,y]=r.useState(o),[w,k]=r.useState([]);r.useEffect(()=>{if("correlation"===p){j(!1);let e=setTimeout(()=>{j(!0)},300);return()=>clearTimeout(e)}j(!1)},[p]),r.useEffect(()=>{if(!u.length)return;let e=u.map(e=>e.revenue).sort((e,t)=>e-t);if(0===e.length)return;let t=(e,t)=>{let a=Math.ceil(t/100*e.length)-1;return e[a]},a=t(e,20),s=t(e,40),r=t(e,60),l=t(e,80),n=Math.max(...e);x([{label:"[0â‚¬ - ".concat(a.toFixed(0),"â‚¬]"),min:0,max:a},{label:"[".concat((a+1).toFixed(0),"â‚¬ - ").concat(s.toFixed(0),"â‚¬]"),min:a+1,max:s},{label:"[".concat((s+1).toFixed(0),"â‚¬ - ").concat(r.toFixed(0),"â‚¬]"),min:s+1,max:r},{label:"[".concat((r+1).toFixed(0),"â‚¬ - ").concat(l.toFixed(0),"â‚¬]"),min:r+1,max:l},{label:"[".concat((l+1).toFixed(0),"â‚¬ - ").concat(n.toFixed(0),"â‚¬]"),min:l+1,max:n}])},[u]);let S=e=>{let t=u.filter(t=>t.variation===e),a=t.length;return 0===a?m.map(()=>0):m.map(e=>t.filter(t=>"number"==typeof t.revenue&&t.revenue>=e.min&&t.revenue<=e.max).length/a*100)},C=e=>e>0?"text-green-500":e<0?"text-red-500":"text-muted-foreground",_=e=>void 0!==e?"".concat(e.toFixed(1),"%"):"-",A=e=>void 0!==e?"".concat(e>0?"+":"").concat(e.toFixed(1)," points"):"-",R=e=>e>=95?{label:"Statistically Significant",color:"text-green-500"}:e>=90?{label:"Partially Significant",color:"text-yellow-500"}:{label:"Not Significant",color:"text-muted-foreground"},T=(e,t)=>{if(!e)return{confidence:0,confidenceLevel:R(0),details:{variation:{count:0,total:0,rate:0},control:{count:0,total:0,rate:0}}};let s=u.filter(t=>t.variation===e),r=u.filter(e=>e.variation===a),l=s.filter(e=>e.revenue>=t.min&&e.revenue<=t.max),n=r.filter(e=>e.revenue>=t.min&&e.revenue<=t.max),i=l.length/s.length*100,o=n.length/r.length*100;return{confidence:95,confidenceLevel:R(95),details:{variation:{count:l.length,total:s.length,rate:i},control:{count:n.length,total:r.length,rate:o}}}},O=()=>[{label:"1 product",min:1,max:1},{label:"2-3 products",min:2,max:3},{label:"4-5 products",min:4,max:5},{label:"6+ products",min:6,max:1/0}].map(e=>{let a={range:e.label};return Object.entries(t).forEach(t=>{let[s]=t,r=u.filter(t=>t.variation===s&&t.quantity>=e.min&&t.quantity<=e.max),l=u.filter(e=>e.variation===s).length,n=r.length/l*100,i=r.length>0?r.reduce((e,t)=>e+t.revenue,0)/r.length:0;a["".concat(s,"_percentage")]=n,a["".concat(s,"_aov")]=i}),a}),D=e=>z([1,2.5,4.5,7],O().map(t=>t["".concat(e,"_aov")])),z=(e,t)=>{let a=e.length,s=e.reduce((e,t)=>e+t,0),r=t.reduce((e,t)=>e+t,0),l=e.reduce((e,t)=>e+t*t,0),n=t.reduce((e,t)=>e+t*t,0),i=e.map((e,a)=>e*t[a]).reduce((e,t)=>e+t,0),o=Math.sqrt((l-s*s/a)*(n-r*r/a));return 0===o?0:(i-s*r/a)/o};if(i)return(0,s.jsx)(ta,{});let E=S(a);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center justify-end",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e7,{onSave:e=>{k(e),u.length&&(u.map(e=>e.revenue).sort((e,t)=>e-t),x(e.map(e=>({label:"[".concat(e.min,"â‚¬ - ").concat(e.max===1/0?"âˆž":e.max,"â‚¬]"),min:e.min,max:e.max}))))}}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:()=>y(!N),className:(0,l.cn)("h-8 w-8",N&&"bg-muted"),children:N?(0,s.jsx)(eV.A,{className:"h-4 w-4"}):(0,s.jsx)(eL.A,{className:"h-4 w-4"})})]})}),(0,s.jsxs)("div",{className:"mt-8 flex gap-4",children:[(0,s.jsx)(ev,{value:h,onValueChange:e=>f(e),orientation:"vertical",className:"border-r border-border/40 pr-4",children:(0,s.jsxs)(eg,{className:"flex flex-col h-auto bg-transparent space-y-2",children:[(0,s.jsxs)(ej,{value:"revenue",className:"flex items-center gap-2 data-[state=active]:bg-primary/10",children:[(0,s.jsx)(eP.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium",children:"Revenue"})]}),(0,s.jsxs)(ej,{value:"quantity",className:"flex items-center gap-2 data-[state=active]:bg-primary/10",children:[(0,s.jsx)(eM.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"font-medium",children:"Quantity"})]})]})}),(0,s.jsx)("div",{className:"flex-1 transition-all duration-200 ease-in-out",style:{opacity:1,transform:"translateX(0)"},children:"revenue"===h?N?(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsx)(d,{className:"pt-6",children:(0,s.jsx)(ChartContainer,{config:tt,className:"mx-auto aspect-square max-h-[400px]",children:(0,s.jsxs)(eq.V,{data:m.map(e=>{let a={range:e.label.replace(/[\[\]â‚¬]/g,"")};return Object.entries(t).forEach(t=>{let[s]=t;a[s]=S(s)[m.indexOf(e)]}),a}),margin:{top:20,right:20,bottom:20,left:20},children:[(0,s.jsx)(ChartTooltip,{content:e=>{var t,r,n;let{active:i,payload:o,label:d,coordinate:c}=e;if(!i||!o)return null;let u=m.find(e=>e.label.replace(/[\[\]â‚¬]/g,"")===d);if(!u)return null;let x=o.find(e=>e.name!==a);if(!(null==x?void 0:x.name))return null;let h=null!==(r=null===(t=o.find(e=>e.name===a))||void 0===t?void 0:t.value)&&void 0!==r?r:0,f=(null!==(n=x.value)&&void 0!==n?n:0)-h,p=T(x.name,u);return(0,s.jsx)("div",{className:"absolute -translate-x-1/2 -translate-y-full mb-2",style:{left:null==c?void 0:c.x,top:null==c?void 0:c.y},children:(0,s.jsx)("div",{className:"w-[380px] bg-background border rounded-lg shadow-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-2 pb-3 border-b border-border",children:[(0,s.jsx)(eO.A,{className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground",children:"Statistical Test"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Mann-Whitney U Test"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground/80 flex items-baseline gap-1",children:[(0,s.jsx)("span",{className:"shrink-0 text-muted-foreground",children:"Confidence Interval (Revenue Distribution):"}),(0,s.jsxs)("span",{className:"font-medium text-muted-foreground/60",children:["[",(f-2).toFixed(2),"%, ",(f+2).toFixed(2),"%]"]})]}),(0,s.jsxs)("p",{className:"text-xs flex items-baseline gap-1",children:[(0,s.jsx)("span",{className:"shrink-0 text-muted-foreground",children:"Statistical Confidence:"}),(0,s.jsxs)("span",{className:(0,l.cn)("font-medium",p.confidenceLevel.color),children:[p.confidence.toFixed(1),"%"]}),(0,s.jsxs)("span",{className:"text-muted-foreground/60",children:["- ",p.confidenceLevel.label]})]})]})]})})})},wrapperStyle:{outline:"none",zIndex:50},cursor:!1}),(0,s.jsx)(eB.z,{stroke:"hsl(var(--border))",strokeOpacity:.3}),(0,s.jsx)(e$.r,{dataKey:"range",tick:{fill:"hsl(var(--muted-foreground))",fontSize:11},tickLine:!1}),Object.keys(t).map(e=>{let t=e===a?te.D6.control:tt[e].color;return(0,s.jsx)(eJ.V,{name:e,dataKey:e,stroke:t,fill:t,fillOpacity:.25,strokeWidth:2},e)}),(0,s.jsx)(ChartLegend,{content:(0,s.jsx)(ChartLegendContent,{}),wrapperStyle:{paddingTop:"1rem",fontSize:"12px"}})]})})})}):(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-10 bg-muted/50",children:"Revenue Range"}),Object.keys(t).map(e=>(0,s.jsx)(er,{className:"h-10 text-right bg-muted/50",children:ts(e)},e))]})}),(0,s.jsx)(ea,{children:m.map((e,r)=>(0,s.jsxs)(es,{className:"h-14",children:[(0,s.jsx)(el,{className:"font-medium",children:e.label}),Object.entries(t).map(t=>{let[n,i]=t,o=S(n),d=n!==a?o[r]-E[r]:null;return(0,s.jsx)(el,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)("div",{className:"tabular-nums",children:_(o[r])}),n!==a&&null!==d&&(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{children:(0,s.jsx)("div",{className:(0,l.cn)("text-sm",C(d)),children:A(d)})}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-4 bg-popover border-border shadow-lg",sideOffset:5,children:(0,s.jsx)(eD,{title:"Mann-Whitney U Test",description:"Non-parametric test comparing revenue distributions within this range.",methodUsed:"stats.mannwhitneyu() with alternative='two-sided'",showCalculationDetails:!0,confidenceInterval:{lower:d-2,upper:d+2,metric:"Revenue Distribution"},confidenceData:{value:T(n,e).confidence,level:T(n,e).confidenceLevel,details:T(n,e).details}})})]})})]})},n)})]},e.label))})]})}):N?(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,s.jsx)("div",{className:"flex justify-end mb-4",children:(0,s.jsx)(ev,{value:p,onValueChange:e=>v(e),children:(0,s.jsxs)(eg,{className:"grid w-full max-w-[400px] grid-cols-2",children:[(0,s.jsxs)(ej,{value:"combo",className:"flex items-center gap-2",children:[(0,s.jsx)(eL.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Distribution & AOV"})]}),(0,s.jsxs)(ej,{value:"correlation",className:"flex items-center gap-2",children:[(0,s.jsx)(eO.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Corr\xe9lation"})]})]})})}),"combo"===p?(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsx)(d,{className:"pt-6",children:(0,s.jsx)(eW.u,{width:"100%",height:400,children:(0,s.jsxs)(eK.E,{data:O(),children:[(0,s.jsx)(eZ.d,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",strokeOpacity:.3}),(0,s.jsx)(eH.W,{dataKey:"range",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,s.jsx)(eQ.h,{yAxisId:"left",orientation:"left",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},label:{value:"Distribution (%)",angle:-90,position:"insideLeft",fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,s.jsx)(eQ.h,{yAxisId:"right",orientation:"right",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},label:{value:"AOV (â‚¬)",angle:90,position:"insideRight",fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,s.jsx)(eG.m,{content:e=>{let{active:r,payload:n,label:i}=e;if(!r||!n)return null;let o=Object.keys(t).map(e=>{let t=n.find(t=>t.dataKey==="".concat(e,"_percentage")),s=Number((null==t?void 0:t.value)||0),r=n.find(e=>e.dataKey==="".concat(a,"_percentage")),l=Number((null==r?void 0:r.value)||0),i=e!==a?(s-l)/l*100:null;return{variation:e,value:s,uplift:i}});return(0,s.jsx)("div",{className:"bg-background border rounded-lg shadow-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-2 pb-3",children:[(0,s.jsx)(eO.A,{className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground",children:"Distribution"}),o.map(e=>(0,s.jsxs)("p",{className:"text-xs text-muted-foreground/80 flex items-baseline gap-1",children:[(0,s.jsxs)("span",{className:"shrink-0 text-muted-foreground",children:[ts(e.variation),":"]}),(0,s.jsxs)("span",{className:"font-medium text-muted-foreground/60",children:[e.value.toFixed(1),"%",null!==e.uplift&&(0,s.jsxs)("span",{className:(0,l.cn)("ml-2",e.uplift>0?"text-green-500":"text-red-500"),children:["(",e.uplift>0?"+":"",e.uplift.toFixed(1),"%)"]})]})]},e.variation))]})]})})},wrapperStyle:{outline:"none",zIndex:50}}),(0,s.jsx)(eY.s,{wrapperStyle:{fontSize:"12px",color:"hsl(var(--muted-foreground))"}}),Object.keys(t).map(e=>(0,s.jsx)(eX.y,{yAxisId:"left",dataKey:"".concat(e,"_percentage"),fill:tt[e].color,name:"".concat(ts(e)," Distribution"),radius:[4,4,0,0]},"".concat(e,"_bar"))),Object.keys(t).map(e=>(0,s.jsx)(e0.N,{yAxisId:"right",type:"monotone",dataKey:"".concat(e,"_aov"),stroke:tt[e].color,name:"".concat(ts(e)," AOV"),dot:{fill:tt[e].color},strokeWidth:2},"".concat(e,"_line")))]})})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsx)(d,{className:"pt-6",children:(0,s.jsx)(eW.u,{width:"100%",height:400,children:(0,s.jsxs)(e1.b,{data:O(),children:[(0,s.jsx)(eZ.d,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",strokeOpacity:.3}),(0,s.jsx)(eH.W,{dataKey:"range",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,s.jsx)(eQ.h,{tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},label:{value:"AOV (â‚¬)",angle:-90,position:"insideLeft",fill:"hsl(var(--muted-foreground))",fontSize:12}}),(0,s.jsx)(eG.m,{content:e=>{let{active:r,payload:n,label:i}=e;if(!r||!n)return null;let o=Object.keys(t).map(e=>{let t=n.find(t=>t.dataKey==="".concat(e,"_aov")),s=Number((null==t?void 0:t.value)||0),r=n.find(e=>e.dataKey==="".concat(a,"_aov")),l=Number((null==r?void 0:r.value)||0),i=e!==a?(s-l)/l*100:null;return{variation:e,value:s,uplift:i}});return(0,s.jsx)("div",{className:"bg-background border rounded-lg shadow-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-2 pb-3",children:[(0,s.jsx)(eO.A,{className:"h-5 w-5 text-primary shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground",children:"AOV"}),o.map(e=>(0,s.jsxs)("p",{className:"text-xs text-muted-foreground/80 flex items-baseline gap-1",children:[(0,s.jsxs)("span",{className:"shrink-0 text-muted-foreground",children:[ts(e.variation),":"]}),(0,s.jsxs)("span",{className:"font-medium text-muted-foreground/60",children:["â‚¬",e.value.toFixed(2),null!==e.uplift&&(0,s.jsxs)("span",{className:(0,l.cn)("ml-2",e.uplift>0?"text-green-500":"text-red-500"),children:["(",e.uplift>0?"+":"",e.uplift.toFixed(1),"%)"]})]})]},e.variation))]})]})})},wrapperStyle:{outline:"none",zIndex:50}}),(0,s.jsx)(eY.s,{wrapperStyle:{fontSize:"12px",color:"hsl(var(--muted-foreground))"}}),Object.keys(t).map(e=>(0,s.jsx)(e0.N,{type:"monotone",dataKey:"".concat(e,"_aov"),stroke:tt[e].color,name:"".concat(ts(e)," AOV"),dot:{fill:tt[e].color},strokeWidth:2},e))]})})})}),(0,s.jsx)("div",{className:"mt-4 space-y-2",children:(0,s.jsxs)("div",{ref:b,className:"space-y-2 bg-muted/50 p-3 rounded-md",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Correlation Analysis"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Quantity vs AOV"})]}),(0,s.jsx)("div",{className:"space-y-3",children:Object.keys(t).map(e=>{let a=Math.abs(100*D(e)),r="";return r=a>=90?"Very Strong":a>=70?"Strong":a>=50?"Moderate":a>=30?"Weak":"Very Weak",(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:[ts(e),":"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:(0,l.cn)("font-medium",a>=70?"text-green-500":a>=50?"text-yellow-500":"text-red-500"),children:[a.toFixed(1),"%"]}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",r,")"]})]})]}),(0,s.jsx)("div",{className:"h-1.5 w-full bg-muted rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:(0,l.cn)("h-full rounded-full transition-all duration-[1500ms] ease-out",a>=70?"bg-green-500":a>=50?"bg-yellow-500":"bg-red-500"),style:{width:g?"".concat(a,"%"):"0%",transitionDelay:"".concat(300*Object.keys(t).indexOf(e),"ms")}})})]},e)})}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Correlation measures the relationship between the number of products and AOV. A strong positive correlation (",">","70%) indicates that AOV significantly increases with product quantity."]})]})})]})]}):(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(en.F,{className:"w-full whitespace-nowrap rounded-md",children:[(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-10 bg-muted/50 sticky left-0 min-w-[150px] z-10",children:"Quantity Range"}),Object.keys(t).map(e=>(0,s.jsx)(er,{className:"h-10 text-right bg-muted/50 min-w-[120px]",children:ts(e)},e))]})}),(0,s.jsx)(ea,{children:[{label:"1 product",min:1,max:1},{label:"2-3 products",min:2,max:3},{label:"4-5 products",min:4,max:5},{label:"6+ products",min:6,max:1/0}].map(e=>(0,s.jsxs)(es,{className:"h-14",children:[(0,s.jsx)(el,{className:"font-medium sticky left-0 bg-background z-10",children:e.label}),Object.entries(t).map(t=>{let[r]=t,n=u.filter(t=>t.variation===r&&t.quantity>=e.min&&t.quantity<=e.max),i=u.filter(e=>e.variation===r).length,o=n.length/i*100,d=u.filter(t=>t.variation===a&&t.quantity>=e.min&&t.quantity<=e.max),c=u.filter(e=>e.variation===a).length,m=d.length/c*100,x=r!==a?o-m:null;return(0,s.jsx)(el,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsx)("div",{className:"tabular-nums",children:_(o)}),r!==a&&null!==x&&(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{children:(0,s.jsx)("div",{className:(0,l.cn)("text-sm",C(x)),children:A(x)})}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-4 bg-popover border-border shadow-lg",sideOffset:5,children:(0,s.jsx)(eD,{title:"Mann-Whitney U Test",description:"Non-parametric test comparing quantity distributions within this range.",methodUsed:"stats.mannwhitneyu() with alternative='two-sided'",showCalculationDetails:!0,confidenceInterval:{lower:x-2,upper:x+2,metric:"Quantity Distribution"},confidenceData:{value:95,level:R(95),details:{variation:{count:n.length,total:i,rate:o,unit:"percentage"},control:{count:d.length,total:c,rate:m,unit:"percentage"}}}})})]})})]})},r)})]},e.label))})]}),(0,s.jsx)(en.$,{orientation:"horizontal"})]})}),(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(en.F,{className:"w-full whitespace-nowrap rounded-md",children:[(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-10 bg-muted/50 sticky left-0 min-w-[150px] z-10",children:"Products"}),Object.keys(t).map(e=>(0,s.jsx)(er,{className:"h-10 text-right bg-muted/50 min-w-[120px]",children:ts(e)},e))]})}),(0,s.jsx)(ea,{children:[{label:"1 product",min:1,max:1},{label:"2-3 products",min:2,max:3},{label:"4-5 products",min:4,max:5},{label:"6+ products",min:6,max:1/0}].map(e=>(0,s.jsxs)(es,{className:"h-14",children:[(0,s.jsx)(el,{className:"font-medium sticky left-0 bg-background z-10",children:e.label}),Object.entries(t).map(t=>{let[r]=t,n=u.filter(t=>t.variation===r&&t.quantity>=e.min&&t.quantity<=e.max),i=u.filter(e=>e.variation===r).length,o=n.length>0?n.reduce((e,t)=>e+t.revenue,0)/n.length:0,d=u.filter(t=>t.variation===a&&t.quantity>=e.min&&t.quantity<=e.max),c=u.filter(e=>e.variation===a).length,m=d.length>0?d.reduce((e,t)=>e+t.revenue,0)/d.length:0,x=r!==a&&m>0?(o-m)/m*100:null;return(0,s.jsx)(el,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,s.jsxs)("div",{className:"tabular-nums",children:["â‚¬",o.toFixed(2)]}),r!==a&&null!==x&&(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{children:(0,s.jsx)("div",{className:(0,l.cn)("text-sm",C(x)),children:x>0?"+".concat(x.toFixed(1),"%"):"".concat(x.toFixed(1),"%")})}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-4 bg-popover border-border shadow-lg",sideOffset:5,children:(0,s.jsx)(eD,{title:"Mann-Whitney U Test",description:"Non-parametric test comparing revenue distributions for this quantity range.",methodUsed:"stats.mannwhitneyu() with alternative='two-sided'",showCalculationDetails:!0,confidenceInterval:{lower:x-2,upper:x+2,metric:"Revenue Distribution"},confidenceData:{value:tl(n.map(e=>e.revenue),d.map(e=>e.revenue)),level:R(95),details:{variation:{count:n.length,total:i,rate:o,unit:"currency"},control:{count:d.length,total:c,rate:m,unit:"currency"}}}})})]})})]})},r)})]},e.label))})]}),(0,s.jsx)(en.$,{orientation:"horizontal"})]})})]})})]})]})}let tl=(e,t)=>{if(0===e.length||0===t.length)return 0;let a=[...e.map(e=>({value:e,group:"var"})),...t.map(e=>({value:e,group:"ctrl"}))].sort((e,t)=>e.value-t.value),s={};for(let e=0;e<a.length;e++)s[e]=e+1;return Math.min(Math.max((1-2*(1-tn(Math.abs((a.filter(e=>"var"===e.group).reduce((e,t,a)=>e+s[a],0)-e.length*(e.length+1)/2-e.length*t.length/2)/Math.sqrt(e.length*t.length*(e.length+t.length+1)/12)))))*100,0),100)},tn=e=>{let t=1/(1+.2316419*Math.abs(e)),a=.3989423*Math.exp(-e*e/2)*t*(.3193815+t*(-.3565638+t*(1.781478+t*(-1.821256+1.330274*t))));return e>0?1-a:a};var ti=a(98867),to=a(90518),td=a(43322),tc=a(5900);let tu=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(tc.bL,{ref:t,className:(0,l.cn)("relative flex w-full touch-none select-none items-center",a),...r,children:[(0,s.jsx)(tc.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,s.jsx)(tc.Q6,{className:"absolute h-full bg-primary"})}),(0,s.jsx)(tc.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});tu.displayName=tc.bL.displayName;let tm=e=>{if(e.toLowerCase().includes("control"))return"Control";for(let t of[/\[.*\]\s*Variation\s*(\d+)/,/var(\d+)/i,/variation\s*(\d+)/i,/v(\d+)/i]){let a=e.match(t);if(a)return"Var ".concat(a[1])}return e},tx=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.95,r=e.filter(e=>e.variation===t).map(e=>e.revenue),l=e.filter(e=>e.variation!==t).map(e=>e.revenue),n=r.reduce((e,t)=>e+t,0)/r.length,i=l.reduce((e,t)=>e+t,0)/l.length,o=Array.from({length:a},()=>{let e=Array.from({length:r.length},()=>r[Math.floor(Math.random()*r.length)]),t=Array.from({length:l.length},()=>l[Math.floor(Math.random()*l.length)]),a=e.reduce((e,t)=>e+t,0)/e.length;return(t.reduce((e,t)=>e+t,0)/t.length-a)/a*100}).sort((e,t)=>e-t),d=(1-s)/2,c=o[Math.floor(d*a)],u=o[Math.floor((1-d)*a)],m=(u-c)/30;return{distribution:Object.entries(o.reduce((e,t)=>{let a=Math.floor((t-c)/m);return e[a]=(e[a]||0)+1,e},{})).map(e=>{let[t,s]=e;return{uplift:c+Number(t)*m,frequency:s/a*100}}),observedDiff:(i-n)/n*100,ciLower:c,ciUpper:u,pValue:o.filter(e=>e<=0).length/a}};function th(e){let{virtualTable:t,filters:a,control:i,data:o}=e,[c,u]=r.useState("distribution"),[m,x]=r.useState(95),[h,f]=r.useState("distribution");r.useEffect(()=>{console.group("RevenueStatistics Props"),console.log("Virtual Table Length:",null==t?void 0:t.length),console.log("Virtual Table Sample:",null==t?void 0:t.slice(0,2)),console.log("Control:",i),console.log("Data:",o),console.log("Filters:",a),console.groupEnd()},[t,i,o,a]);let p=e=>e>=95?{label:"Statistically Significant",color:"text-green-500"}:e>=90?{label:"Partially Significant",color:"text-yellow-500"}:{label:"Not Significant",color:"text-muted-foreground"},v=e=>{let t=e.map(e=>e.revenue).sort((e,t)=>e-t),a=t.length;return{median:t[Math.floor(a/2)],mean:t.reduce((e,t)=>e+t,0)/a,q1:t[Math.floor(a/4)],q3:t[Math.floor(3*a/4)],total:t.reduce((e,t)=>e+t,0),count:a}},g=()=>{let e=[0,100,200,300,400,500,750,1e3,1500,2e3,3e3,4e3,5e3];return e.map((a,s)=>{let r=e[s+1]||1.5*a,l={range:a,rangeEnd:r,label:"â‚¬".concat(a," - â‚¬").concat(r)};return Object.keys(o).forEach(e=>{let s=t.filter(t=>t.variation===e&&t.revenue>=a&&t.revenue<r),n=t.filter(t=>t.variation===e),i=s.length/n.length*100;l["".concat(e,"_density")]=i,l["".concat(e,"_stats")]={count:s.length,total:n.length,mean:s.length>0?s.reduce((e,t)=>e+t.revenue,0)/s.length:0}}),l}).filter(e=>Object.keys(o).some(t=>e["".concat(t,"_density")]>0))};return r.useEffect(()=>{console.log("Active chart changed to:",c)},[c]),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,s.jsx)("div",{children:(0,s.jsx)(ev,{value:c,onValueChange:e=>u(e),children:(0,s.jsxs)(eg,{className:"h-9 w-fit bg-muted p-1 rounded-lg",children:[(0,s.jsx)(ej,{value:"distribution",className:"h-7 px-3 rounded data-[state=active]:bg-background",children:"Distribution"}),(0,s.jsx)(ej,{value:"uplift",className:"h-7 px-3 rounded data-[state=active]:bg-background",children:"Uplift"}),(0,s.jsx)(ej,{value:"category",className:"h-7 px-3 rounded data-[state=active]:bg-background",children:"Category"})]})})}),"uplift"===c&&(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,s.jsxs)("label",{className:"text-sm font-medium",children:["Confidence Level: ",m,"%"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Adjust the statistical confidence level for the analysis"})]}),(0,s.jsx)("div",{className:"flex-1 px-4",children:(0,s.jsx)(tu,{value:[m],onValueChange:e=>{let[t]=e;return x(t)},min:80,max:99,step:1,className:"w-full"})})]}),(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsx)(d,{className:"pt-6",children:(0,s.jsx)(eW.u,{width:"100%",height:400,children:(()=>{switch(c){case"distribution":return(0,s.jsxs)(e1.b,{data:g(),margin:{top:20,right:30,left:20,bottom:20},children:[(0,s.jsx)(eZ.d,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",strokeOpacity:.3}),(0,s.jsx)(eH.W,{dataKey:"label",tick:{fill:"hsl(var(--muted-foreground))",fontSize:11},angle:-45,textAnchor:"end",height:60}),(0,s.jsx)(eQ.h,{domain:[0,"auto"],tick:{fill:"hsl(var(--muted-foreground))",fontSize:12},label:{value:"Distribution (%)",angle:-90,position:"insideLeft",fill:"hsl(var(--muted-foreground))"}}),Object.keys(o).map((e,t)=>(0,s.jsx)(to.G,{type:"basis",dataKey:"".concat(e,"_density"),stroke:"none",fill:(0,te.TU)(e,i,t),fillOpacity:.1},"".concat(e,"-area"))),Object.keys(o).map((e,t)=>(0,s.jsx)(e0.N,{type:"monotone",dataKey:"".concat(e,"_density"),stroke:(0,te.TU)(e,i,t),strokeWidth:2,dot:a=>a.payload["".concat(e,"_density")]>5?(0,s.jsx)("circle",{cx:a.cx,cy:a.cy,r:4,fill:(0,te.TU)(e,i,t),stroke:"white",strokeWidth:2}):null,activeDot:{r:6,stroke:"white",strokeWidth:2,fill:(0,te.TU)(e,i,t)}},e)),Object.keys(o).map((e,a)=>{let r=v(t.filter(t=>t.variation===e));return(0,s.jsx)(td.e,{x:r.median,stroke:(0,te.TU)(e,i,a),strokeDasharray:"3 3",label:{value:"Median ".concat(tm(e)),fill:"hsl(var(--muted-foreground))",fontSize:10}},"median-".concat(e))}),(0,s.jsx)(eG.m,{content:e=>{let{active:t,payload:a,label:r}=e;if(!t||!(null==a?void 0:a[0]))return null;let n=a[0].payload,d=Object.keys(o).find(e=>e!==i),c=n["".concat(i,"_stats")],u=n["".concat(d,"_stats")];return(0,s.jsx)("div",{className:"w-[380px] bg-white border rounded-lg shadow-lg p-4",children:(0,s.jsx)(eD,{title:"Statistical Test",description:"Revenue Distribution Analysis",methodUsed:"Mann-Whitney U Test",showCalculationDetails:!0,confidenceInterval:{lower:n.range,upper:n.rangeEnd,metric:"Revenue"},confidenceData:{value:95,level:p(95),details:{control:{count:c.count,total:c.total,rate:c.mean,unit:"currency"},variation:{count:u.count,total:u.total,rate:u.mean,unit:"currency"}}},children:(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-border",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Distribution:"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[n["".concat(i,"_density")].toFixed(1),"% vs ",n["".concat(d,"_density")].toFixed(1),"%"]}),(0,s.jsxs)("span",{className:(0,l.cn)("text-sm font-medium",u.mean>c.mean?"text-green-500":"text-red-500"),children:["(",u.mean>c.mean?"+":"",((u.mean-c.mean)/c.mean*100).toFixed(1),"%)"]})]})]})})})})},wrapperStyle:{zIndex:1e3,outline:"none"},cursor:{strokeDasharray:"3 3"},allowEscapeViewBox:{x:!1,y:!0},position:{x:"auto",y:"auto"}})]});case"uplift":let e=tx(t,i,1e3,m/100);return(0,s.jsxs)(eK.E,{data:e.distribution,margin:{top:20,right:30,bottom:30,left:40},children:[(0,s.jsx)("defs",{children:(0,s.jsxs)("linearGradient",{id:"upliftGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,s.jsx)("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.8}),(0,s.jsx)("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:.2})]})}),(0,s.jsx)(eZ.d,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3}),(0,s.jsx)(eH.W,{dataKey:"uplift",type:"number",tickFormatter:e=>"".concat(e.toFixed(1),"%"),label:{value:"Revenue Uplift (%)",position:"bottom",offset:20,fill:"hsl(var(--muted-foreground))",fontSize:12},tick:{fill:"hsl(var(--muted-foreground))",fontSize:11}}),(0,s.jsx)(eQ.h,{label:{value:"Frequency (%)",angle:-90,position:"left",offset:10,fill:"hsl(var(--muted-foreground))",fontSize:12},tick:{fill:"hsl(var(--muted-foreground))",fontSize:11}}),(0,s.jsx)(eX.y,{dataKey:"frequency",fill:"url(#upliftGradient)",radius:[4,4,0,0],children:e.distribution.map((e,t)=>e.frequency>5&&(0,s.jsxs)("text",{x:0,y:0,dy:-6,fill:"hsl(var(--muted-foreground))",fontSize:10,textAnchor:"middle",children:[e.frequency.toFixed(1),"%"]},"label-".concat(t)))}),(0,s.jsx)(td.e,{x:e.observedDiff,stroke:"hsl(var(--destructive))",strokeWidth:2,label:{value:"Observed",position:"top",fill:"hsl(var(--destructive))",fontSize:11}}),(0,s.jsx)(td.e,{x:e.ciLower,stroke:"hsl(var(--muted))",strokeDasharray:"5 5",label:{value:"".concat(m,"% CI"),position:"top",fill:"hsl(var(--muted-foreground))",fontSize:11}}),(0,s.jsx)(td.e,{x:e.ciUpper,stroke:"hsl(var(--muted))",strokeDasharray:"5 5"}),(0,s.jsx)(eG.m,{content:t=>{let{active:a,payload:r}=t;if(!a||!(null==r?void 0:r[0]))return null;let n=r[0].payload;return(0,s.jsx)("div",{className:"w-[380px] bg-white border rounded-lg shadow-lg p-4",children:(0,s.jsx)(eD,{title:"Uplift Distribution",description:"Bootstrap Analysis (".concat(m,"% CI)"),methodUsed:"Bootstrap Resampling",showCalculationDetails:!0,confidenceInterval:{lower:Number(e.ciLower),upper:Number(e.ciUpper),metric:"Revenue Uplift"},confidenceData:{value:Number((1-e.pValue)*100),level:p(Number((1-e.pValue)*100)),details:{variation:{count:Math.round(Number(n.frequency)),total:1e3,rate:Number(n.uplift),unit:"percentage"},control:{count:Math.round(100*Number(e.observedDiff))/100,total:100,rate:0,unit:"percentage"}}},children:(0,s.jsxs)("div",{className:"mt-4 space-y-3 border-t pt-4 border-border",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Observed Uplift:"}),(0,s.jsxs)("span",{className:(0,l.cn)("text-sm font-medium",e.observedDiff>0?"text-green-500":"text-red-500"),children:[e.observedDiff>0?"+":"",e.observedDiff.toFixed(2),"%"]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Confidence Interval:"}),(0,s.jsxs)("span",{className:"text-sm",children:["[",e.ciLower.toFixed(2),"%, ",e.ciUpper.toFixed(2),"%]"]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"P-value:"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:e.pValue.toFixed(3)})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground",children:"Current Distribution Point"}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Uplift Value:"}),(0,s.jsx)("span",{className:"text-sm",children:"number"==typeof n.uplift?"".concat(n.uplift.toFixed(2),"%"):"-"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Frequency:"}),(0,s.jsx)("span",{className:"text-sm",children:"number"==typeof n.frequency?"".concat(n.frequency.toFixed(2),"%"):"-"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:(0,l.cn)("h-2 w-2 rounded-full",e.pValue<1-m/100?"bg-green-500":"bg-yellow-500")}),(0,s.jsx)("span",{className:(0,l.cn)("text-sm font-medium",e.pValue<1-m/100?"text-green-500":"text-yellow-500"),children:e.pValue<1-m/100?"Statistically Significant":"Not Significant"})]})]})})})},wrapperStyle:{zIndex:1e3,outline:"none"},cursor:!1})]});case"category":return(0,s.jsxs)(eK.E,{data:[],children:[(0,s.jsx)(eH.W,{}),(0,s.jsx)(eQ.h,{})]});default:return null}})()})})})]})}let tf=[{key:"users",label:"Users",type:"number",showStats:!1},{key:"transaction_rate",label:"Transaction Rate",type:"rate",showStats:!0},{key:"aov",label:"AOV",type:"currency",showStats:!0},{key:"avg_products",label:"Avg Products",type:"quantity",showStats:!0}],tp=[{key:"total_revenue",label:"Total Revenue",type:"currency",showStats:!0},{key:"arpu",label:"ARPU",type:"currency",showStats:!0}],tv=e=>{switch(e){case"transaction_rate":return"percentage";case"aov":case"total_revenue":case"arpu":return"currency";case"avg_products":return"quantity";default:return}},tg=(e,t)=>{var a,r,l,n,i,o,d,c,u,m,x,h;let f=(e=>{var a,s,r,l,n,i,o,d,c,u,m,x;switch(e){case"transaction_rate":return{test:"Fisher's Exact Test",description:"Compares conversion rates between variations",implementation:"stats.fisher_exact()",confidenceInterval:{lower:(null===(a=t.confidence_interval)||void 0===a?void 0:a.lower)||0,upper:(null===(s=t.confidence_interval)||void 0===s?void 0:s.upper)||0,metric:"Transaction Rate"}};case"aov":return{test:"Mann-Whitney U Test",description:"Non-parametric test for comparing AOV distributions",implementation:"stats.mannwhitneyu(alternative='two-sided')",confidenceInterval:{lower:(null===(r=t.confidence_interval)||void 0===r?void 0:r.lower)||0,upper:(null===(l=t.confidence_interval)||void 0===l?void 0:l.upper)||0,metric:"Average Order Value"}};case"avg_products":return{test:"Mann-Whitney U Test",description:"Non-parametric test for comparing product quantity distributions",implementation:"stats.mannwhitneyu(alternative='two-sided')",confidenceInterval:{lower:(null===(n=t.confidence_interval)||void 0===n?void 0:n.lower)||0,upper:(null===(i=t.confidence_interval)||void 0===i?void 0:i.upper)||0,metric:"Average Products"}};case"total_revenue":return{test:"Mann-Whitney U Test",description:"Non-parametric test comparing revenue distributions. Robust against typical revenue data skewness.",implementation:"stats.mannwhitneyu() with alternative='two-sided'",confidenceInterval:{lower:(null===(o=t.confidence_interval)||void 0===o?void 0:o.lower)||0,upper:(null===(d=t.confidence_interval)||void 0===d?void 0:d.upper)||0,metric:"Total Revenue"}};case"arpu":return{test:"Mann-Whitney U Test",description:"Non-parametric test comparing revenue distributions per user. Robust against non-normal distributions and outliers.",implementation:"stats.mannwhitneyu(alternative='two-sided') with bootstrap CI",confidenceInterval:{lower:(null===(c=t.confidence_interval)||void 0===c?void 0:c.lower)||0,upper:(null===(u=t.confidence_interval)||void 0===u?void 0:u.upper)||0,metric:"Revenue per User"}};default:return{test:"Student's t-test",description:"Parametric test for comparing means",implementation:"stats.ttest_ind(equal_var=False)",confidenceInterval:{lower:(null===(m=t.confidence_interval)||void 0===m?void 0:m.lower)||0,upper:(null===(x=t.confidence_interval)||void 0===x?void 0:x.upper)||0,metric:e}}}})(e);return(0,s.jsx)(eD,{title:f.test,description:f.description,methodUsed:f.implementation,showCalculationDetails:!0,confidenceInterval:f.confidenceInterval,confidenceData:{value:t.confidence||0,level:tb(t.confidence||0),details:{variation:{count:(null===(r=t.details)||void 0===r?void 0:null===(a=r.variation)||void 0===a?void 0:a.count)||0,total:(null===(n=t.details)||void 0===n?void 0:null===(l=n.variation)||void 0===l?void 0:l.total)||0,rate:(null===(o=t.details)||void 0===o?void 0:null===(i=o.variation)||void 0===i?void 0:i.rate)||0,unit:tv(e)},control:{count:(null===(c=t.details)||void 0===c?void 0:null===(d=c.control)||void 0===d?void 0:d.count)||0,total:(null===(m=t.details)||void 0===m?void 0:null===(u=m.control)||void 0===u?void 0:u.total)||0,rate:(null===(h=t.details)||void 0===h?void 0:null===(x=h.control)||void 0===x?void 0:x.rate)||0,unit:tv(e)}}}})};function tj(e){let{rows:t=3,showSecondaryMetrics:a=!1}=e;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("div",{className:"w-[200px] h-10 bg-muted animate-pulse rounded-md"}),(0,s.jsx)("div",{className:"w-[200px] h-10 bg-muted animate-pulse rounded-md"})]}),(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-12 bg-muted/50",children:(0,s.jsx)("div",{className:"w-24 h-4 bg-muted animate-pulse rounded"})}),[void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(er,{className:"h-12 text-right bg-muted/50",children:(0,s.jsx)("div",{className:"w-20 h-4 bg-muted animate-pulse rounded ml-auto"})},t))]})}),(0,s.jsx)(ea,{children:[...Array(t)].map((e,t)=>(0,s.jsxs)(es,{className:"h-[72px]",children:[(0,s.jsx)(el,{children:(0,s.jsx)("div",{className:"w-32 h-4 bg-muted animate-pulse rounded"})}),[void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsx)(el,{className:"text-right",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"w-24 h-4 bg-muted animate-pulse rounded ml-auto"}),t>0&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"w-16 h-3 bg-muted animate-pulse rounded ml-auto"}),(0,s.jsx)("div",{className:"w-12 h-3 bg-muted animate-pulse rounded ml-auto"})]})]})},a))]},t))})]})}),a&&(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4 mt-8",children:[void 0,void 0].map((e,a)=>(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-12 bg-muted/50",children:(0,s.jsx)("div",{className:"w-24 h-4 bg-muted animate-pulse rounded"})}),(0,s.jsx)(er,{className:"h-12 text-right bg-muted/50",children:(0,s.jsx)("div",{className:"w-20 h-4 bg-muted animate-pulse rounded ml-auto"})})]})}),(0,s.jsx)(ea,{children:[...Array(t)].map((e,t)=>(0,s.jsxs)(es,{className:"h-[72px]",children:[(0,s.jsx)(el,{children:(0,s.jsx)("div",{className:"w-32 h-4 bg-muted animate-pulse rounded"})}),(0,s.jsx)(el,{className:"text-right",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"w-24 h-4 bg-muted animate-pulse rounded ml-auto"}),t>0&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("div",{className:"w-16 h-3 bg-muted animate-pulse rounded ml-auto"}),(0,s.jsx)("div",{className:"w-12 h-3 bg-muted animate-pulse rounded ml-auto"})]})]})})]},t))})]})},a))})]})}let tb=e=>e>=95?{label:"Statistically Significant",color:"text-green-500"}:e>=90?{label:"Partially Significant",color:"text-yellow-500"}:{label:"Not Significant",color:"text-muted-foreground"};function tN(e){var t;let{data:a,isLoading:i=!1}=e,[o,d]=r.useState("all"),[u,m]=r.useState(["all"]),[x,h]=r.useState("all"),[f,p]=r.useState([]),[v,g]=r.useState([]),[j,b]=r.useState(!0),[N,y]=r.useState(null),[w,k]=r.useState(null),[S,C]=r.useState(!0),[_,A]=r.useState(!1),R=r.useRef(null),T=r.useRef(null),[O,D]=r.useState({aovColPosition:0,tableHeight:0,leftTablePosition:0,rightTablePosition:0}),[z,E]=r.useState([]),F=r.useCallback(()=>{if(R.current&&T.current){let e=R.current.getBoundingClientRect(),t=T.current.getBoundingClientRect(),a=t.left-e.left+t.width/2,s=e.height,r=e.width;D({aovColPosition:a,tableHeight:s,leftTablePosition:.25*r,rightTablePosition:.75*r})}},[]);r.useEffect(()=>{let e=new ResizeObserver(F);return R.current&&e.observe(R.current),()=>e.disconnect()},[F]),r.useEffect(()=>{F()},[N,F]),r.useEffect(()=>{var e,t;(null==a?void 0:null===(t=a.analysisData)||void 0===t?void 0:null===(e=t.raw_data)||void 0===e?void 0:e.transaction)&&(p(Array.from(new Set(a.analysisData.raw_data.transaction.flatMap(e=>{var t;return null===(t=e.item_category2)||void 0===t?void 0:t.split("|").map(e=>e.trim().split("(")[0].trim())}).filter(Boolean))).filter(e=>!e.includes("+")).sort()),b(!1))},[a]),r.useEffect(()=>{var e,t;(null==a?void 0:null===(t=a.analysisData)||void 0===t?void 0:null===(e=t.raw_data)||void 0===e?void 0:e.transaction)&&g(Array.from(new Set(a.analysisData.raw_data.transaction.map(e=>e.device_category).filter(Boolean))).sort())},[a]);let I=r.useCallback(async()=>{try{var e,t,s,r;C(!0),k(null);let l=(null==a?void 0:null===(t=a.analysisData)||void 0===t?void 0:null===(e=t.raw_data)||void 0===e?void 0:e.transaction.filter(e=>{var t;let a="all"===o||e.device_category===o;if(u.includes("all"))return a;let s=(null===(t=e.item_category2)||void 0===t?void 0:t.split("|").map(e=>e.trim()).filter(Boolean))||[],r=u.every(e=>s.some(t=>t.toLowerCase().includes(e.toLowerCase())));return a&&r}))||[];if(0===l.length){k("No transactions found with the selected filters"),y(null),E([]);return}let n={raw_data:{transaction:l,overall:null==a?void 0:null===(r=a.analysisData)||void 0===r?void 0:null===(s=r.raw_data)||void 0===s?void 0:s.overall}},i=await fetch("http://localhost:8000/calculate-revenue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!i.ok){let e=await i.json();throw Error(e.detail||"Failed to fetch revenue data")}let d=await i.json();y(d),E(d.virtual_table||[])}catch(e){console.error("Revenue calculation error:",e),k("Error calculating revenue metrics")}finally{C(!1)}},[a,o,u]);r.useEffect(()=>{var e;(null==a?void 0:null===(e=a.analysisData)||void 0===e?void 0:e.raw_data)&&I()},[a,o,u]);let U=(e,t)=>null==e?"-":"uplift"===t?"".concat(e>0?"+":"").concat(e.toFixed(2),"%"):"rate"===t||"confidence"===t?"".concat(e.toFixed(2),"%"):"currency"===t?"â‚¬".concat(e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})):e.toLocaleString(),V=e=>e>0?"text-green-500":"text-red-500",L=(e,t,a)=>{if(void 0===t||!a)return!1;let s=Object.values(a).map(t=>{var a;return null==t?void 0:null===(a=t[e])||void 0===a?void 0:a.value}).filter(e=>void 0!==e);return s.length>0&&Math.max(...s)===t},[P,M]=r.useState([]);return(r.useEffect(()=>{(null==N?void 0:N.virtual_table)&&M(N.virtual_table.filter(e=>{let t="all"===o||e.device_category===o,a=u.includes("all")||u.some(t=>{var a;return null===(a=e.item_category2)||void 0===a?void 0:a.toLowerCase().includes(t.toLowerCase())});return t&&a}))},[null==N?void 0:N.virtual_table,o,u]),i||S)?(0,s.jsx)(tj,{rows:3,showSecondaryMetrics:!0}):w?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"font-semibold text-red-500",children:w}),w.includes("No transactions found")&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:'Try adjusting your filters or selecting "All Categories" to see more results.'})]}),(0,s.jsxs)("div",{className:"flex justify-center gap-2 mt-4",children:[(0,s.jsxs)(ec.l6,{value:o,onValueChange:d,children:[(0,s.jsx)(ec.bq,{className:"w-[200px]",children:(0,s.jsx)(ec.yv,{placeholder:"Select device"})}),(0,s.jsxs)(ec.gC,{children:[(0,s.jsx)(ec.eb,{value:"all",children:"All Devices"}),(0,s.jsx)(ec.eb,{value:"desktop",children:"Desktop"}),(0,s.jsx)(ec.eb,{value:"mobile",children:"Mobile"}),(0,s.jsx)(ec.eb,{value:"tablet",children:"Tablet"})]})]}),(0,s.jsxs)(ec.l6,{value:x,onValueChange:e=>{if(h(e),"all"===e)m(["all"]);else{let t=u.filter(e=>"all"!==e).includes(e)?u.filter(t=>t!==e):[...u.filter(e=>"all"!==e),e];m(t.length?t:["all"])}},disabled:j,children:[(0,s.jsx)(ec.bq,{className:"w-[280px]",children:j?(0,s.jsx)("div",{className:"w-full h-4 bg-muted animate-pulse rounded"}):(0,s.jsx)(ec.yv,{children:u.includes("all")?"All Categories":"".concat(u.length," selected")})}),(0,s.jsxs)(ec.gC,{children:[(0,s.jsx)(ec.eb,{value:"all",children:"All Categories"}),f.map(e=>(0,s.jsx)(ec.eb,{value:e,className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:(0,l.cn)("h-4 w-4 border rounded flex items-center justify-center",u.includes(e)&&"bg-primary border-primary"),children:u.includes(e)&&(0,s.jsx)(ti.A,{className:"h-3 w-3 text-primary-foreground"})}),(0,s.jsx)("span",{children:e})]})},e))]})]})]})]}):(null==N?void 0:N.success)&&(null==N?void 0:N.data)?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsxs)(ec.l6,{value:o,onValueChange:d,children:[(0,s.jsx)(ec.bq,{className:"w-[200px]",children:(0,s.jsx)(ec.yv,{placeholder:"Select device"})}),(0,s.jsxs)(ec.gC,{children:[(0,s.jsx)(ec.eb,{value:"all",children:"All Devices"}),(0,s.jsx)(ec.eb,{value:"desktop",children:"Desktop"}),(0,s.jsx)(ec.eb,{value:"mobile",children:"Mobile"}),(0,s.jsx)(ec.eb,{value:"tablet",children:"Tablet"})]})]}),(0,s.jsxs)(ec.l6,{value:x,onValueChange:e=>{if(h(e),"all"===e)m(["all"]);else{let t=u.filter(e=>"all"!==e).includes(e)?u.filter(t=>t!==e):[...u.filter(e=>"all"!==e),e];m(t.length?t:["all"])}},disabled:j,children:[(0,s.jsx)(ec.bq,{className:"w-[280px]",children:j?(0,s.jsx)("div",{className:"w-full h-4 bg-muted animate-pulse rounded"}):(0,s.jsx)(ec.yv,{children:u.includes("all")?"All Categories":"".concat(u.length," selected")})}),(0,s.jsxs)(ec.gC,{children:[(0,s.jsx)(ec.eb,{value:"all",children:"All Categories"}),f.map(e=>(0,s.jsx)(ec.eb,{value:e,className:"flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:(0,l.cn)("h-4 w-4 border rounded flex items-center justify-center",u.includes(e)&&"bg-primary border-primary"),children:u.includes(e)&&(0,s.jsx)(ti.A,{className:"h-3 w-3 text-primary-foreground"})}),(0,s.jsx)("span",{children:e})]})},e))]})]})]}),(0,s.jsxs)("div",{className:"space-y-8 pb-8 border-b border-border/40",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground/70",children:"Primary Metrics"}),(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-12 bg-muted/50",children:"Variation"}),tf.map(e=>(0,s.jsx)(er,{className:"h-12 text-right bg-muted/50",ref:"aov"===e.key?T:void 0,children:e.label},e.key))]})}),(0,s.jsx)(ea,{children:Object.entries(N.data).map((e,t)=>{let[a,r]=e;return(0,s.jsxs)(es,{className:(0,l.cn)("h-[72px] hover:bg-muted/50 transition-colors",a===N.control&&"bg-muted/30"),children:[(0,s.jsx)(el,{className:"font-medium",children:a}),tf.map(e=>{var t,n;return(0,s.jsx)(el,{className:"text-right p-4",children:(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("div",{className:(0,l.cn)("tabular-nums",(null==r?void 0:null===(t=r[e.key])||void 0===t?void 0:t.value)!==void 0&&L(e.key,r[e.key].value,N.data)&&"font-semibold"),children:U(null==r?void 0:null===(n=r[e.key])||void 0===n?void 0:n.value,e.type)}),a!==N.control&&e.showStats&&(null==r?void 0:r[e.key])&&(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("div",{className:(0,l.cn)("text-sm flex items-center justify-end gap-1 cursor-help",V(r[e.key].uplift)),children:(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsxs)(e_.k$,{className:"flex items-center gap-1",children:[r[e.key].uplift>0?(0,s.jsx)(eI.A,{className:"h-4 w-4"}):(0,s.jsx)(eU.A,{className:"h-4 w-4"}),U(r[e.key].uplift,"uplift")]}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-4 bg-popover border-border shadow-lg",sideOffset:5,children:tg(e.key,r[e.key])})]})})}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground cursor-help",children:["Stats : ",U(r[e.key].confidence,"confidence")]})]})]})},e.key)})]},a)})})]})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground/70",children:"Secondary Metrics"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4 relative",children:tp.map((e,t)=>(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-12 bg-muted/50",children:"Variation"}),(0,s.jsx)(er,{className:"h-12 text-right bg-muted/50",children:e.label})]})}),(0,s.jsx)(ea,{children:Object.entries(N.data).map(t=>{let[a,r]=t;return(0,s.jsxs)(es,{className:(0,l.cn)("h-[72px] hover:bg-muted/50 transition-colors",a===N.control&&"bg-muted/30"),children:[(0,s.jsx)(el,{className:"font-medium",children:a}),(0,s.jsx)(el,{className:"text-right p-4",children:(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("div",{className:"tabular-nums",children:U(r[e.key].value,e.type)}),a!==N.control&&e.showStats&&(null==r?void 0:r[e.key])&&(0,s.jsxs)("div",{className:"space-y-1.5",children:[(0,s.jsx)("div",{className:(0,l.cn)("text-sm flex items-center justify-end gap-1 cursor-help",V(r[e.key].uplift)),children:(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsxs)(e_.k$,{className:"flex items-center gap-1",children:[r[e.key].uplift>0?(0,s.jsx)(eI.A,{className:"h-4 w-4"}):(0,s.jsx)(eU.A,{className:"h-4 w-4"}),U(r[e.key].uplift,"uplift")]}),(0,s.jsx)(e_.ZI,{side:"left",align:"start",className:"p-4 bg-popover border-border shadow-lg",sideOffset:5,children:tg(e.key,r[e.key])})]})})}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground cursor-help",children:["Stats : ",U(r[e.key].confidence,"confidence")]})]})]})})]},a)})})]})},e.key))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground/70",children:"Revenue Distribution"}),(0,s.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>A(!_),className:"text-muted-foreground hover:text-foreground",children:_?(0,s.jsx)(eV.A,{className:"h-4 w-4"}):(0,s.jsx)(eL.A,{className:"h-4 w-4"})})]}),N&&(0,s.jsx)(tr,{data:N.data,control:N.control,isLoading:i||S,showChart:_,virtualTable:P})]}),(0,s.jsxs)("div",{className:"space-y-2 mt-8 border-t pt-8",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground/70",children:"Revenue Statistics"}),N&&(0,s.jsx)(th,{virtualTable:P,filters:{device:o,categories:u},control:N.control,data:N.data})]}),(0,s.jsxs)("div",{className:"space-y-2 mt-8 border-t pt-8",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground/70",children:"Transaction Details"}),(0,s.jsx)(n,{className:"rounded-lg border bg-card",children:(0,s.jsxs)(en.F,{className:"w-full whitespace-nowrap rounded-md",children:[(0,s.jsxs)(ee,{children:[(0,s.jsx)(et,{children:(0,s.jsxs)(es,{className:"hover:bg-transparent border-b",children:[(0,s.jsx)(er,{className:"h-10 bg-muted/50 sticky left-0 min-w-[200px] z-10",children:"Variation"}),(0,s.jsx)(er,{className:"h-10 bg-muted/50 min-w-[150px]",children:"Transaction ID"}),(0,s.jsx)(er,{className:"h-10 bg-muted/50 min-w-[400px]",children:"Product"}),(0,s.jsx)(er,{className:"h-10 bg-muted/50 min-w-[300px]",children:"Category"}),(0,s.jsx)(er,{className:"h-10 bg-muted/50 min-w-[100px] text-right",children:"Quantity"}),(0,s.jsx)(er,{className:"h-10 bg-muted/50 min-w-[150px] text-right",children:"Revenue"})]})}),(0,s.jsx)(ea,{children:null==N?void 0:null===(t=N.virtual_table)||void 0===t?void 0:t.slice(0,10).map(e=>(0,s.jsxs)(es,{className:"h-14",children:[(0,s.jsx)(el,{className:"font-medium sticky left-0 bg-background min-w-[200px] z-10",children:e.variation}),(0,s.jsx)(el,{className:"min-w-[150px]",children:e.transaction_id}),(0,s.jsx)(el,{className:"min-w-[400px]",children:(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{className:"text-left w-full truncate block",children:e.item_name}),(0,s.jsx)(e_.ZI,{children:e.item_name})]})})}),(0,s.jsx)(el,{className:"min-w-[300px]",children:(0,s.jsx)(e_.TooltipProvider,{children:(0,s.jsxs)(e_.m_,{children:[(0,s.jsx)(e_.k$,{className:"text-left w-full truncate block",children:e.item_category2}),(0,s.jsx)(e_.ZI,{children:e.item_category2})]})})}),(0,s.jsx)(el,{className:"text-right min-w-[100px]",children:e.quantity}),(0,s.jsxs)(el,{className:"text-right min-w-[150px]",children:["â‚¬",e.revenue.toFixed(2)]})]},e.transaction_id))})]}),(0,s.jsx)(en.$,{orientation:"horizontal"})]})})]})]}):(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No data available"})}var ty=a(63348),tw=a(7410),tk=a(48539),tS=a(95316),tC=a(46967),t_=a(33565);let tA=tS.bL,tR=tS.l9;tS.YJ,tS.ZL,tS.Pb,tS.z6,r.forwardRef((e,t)=>{let{className:a,inset:r,children:n,...i}=e;return(0,s.jsxs)(tS.ZP,{ref:t,className:(0,l.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",r&&"pl-8",a),...i,children:[n,(0,s.jsx)(tC.A,{className:"ml-auto h-4 w-4"})]})}).displayName=tS.ZP.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tS.G5,{ref:t,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=tS.G5.displayName;let tT=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tS.ZL,{children:(0,s.jsx)(tS.UC,{ref:t,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})})});tT.displayName=tS.UC.displayName;let tO=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(tS.q7,{ref:t,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",a),...n})});tO.displayName=tS.q7.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:n,...i}=e;return(0,s.jsxs)(tS.H_,{ref:t,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(tS.VF,{children:(0,s.jsx)(ti.A,{className:"h-4 w-4"})})}),r]})}).displayName=tS.H_.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(tS.hN,{ref:t,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(tS.VF,{children:(0,s.jsx)(t_.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=tS.hN.displayName,r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(tS.JU,{ref:t,className:(0,l.cn)("px-2 py-1.5 text-sm font-semibold text-foreground",r&&"pl-8",a),...n})}).displayName=tS.JU.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(tS.wv,{ref:t,className:(0,l.cn)("-mx-1 my-1 h-px bg-border",a),...r})}).displayName=tS.wv.displayName;var tD=a(1280),tz=a(81190);function tE(e){let{onSave:t,onCancel:a,activeTab:n,filters:i}=e,[o,d]=r.useState(""),[u,m]=r.useState(!1),[x,h]=r.useState(!1),f=async()=>{if(o.trim()){m(!0);try{let e=JSON.parse(localStorage.getItem("analysis-comments")||"[]"),a={id:Date.now(),content:o,timestamp:new Date().toISOString(),tab:n,filters:{device_category:i.device_category||[],item_category2:i.item_category2||[]}},s=[...e,a];localStorage.setItem("analysis-comments",JSON.stringify(s)),await new Promise(e=>setTimeout(e,500)),h(!0),setTimeout(()=>{t(o)},500)}finally{m(!1)}}};return(0,s.jsxs)("div",{className:(0,l.cn)("p-2 w-64 bg-background/95 backdrop-blur-sm","shadow-lg rounded-lg border border-border/50","transition-all duration-200"),onClick:e=>e.stopPropagation(),children:[(0,s.jsx)($.T,{value:o,onChange:e=>{d(e.target.value),h(!1)},className:(0,l.cn)("min-h-[80px] resize-none","bg-transparent border-none","focus-visible:ring-0","placeholder:text-muted-foreground/50","text-sm"),placeholder:"Add a comment...",onClick:e=>e.stopPropagation()}),(0,s.jsxs)("div",{className:"flex justify-end items-center gap-2 mt-2",children:[x&&(0,s.jsx)("span",{className:"text-xs text-green-500 mr-auto",children:"Saved"}),(0,s.jsx)(c.$,{size:"sm",variant:"ghost",onClick:a,className:"h-7 px-2",children:(0,s.jsx)(g.A,{className:"h-4 w-4"})}),(0,s.jsx)(c.$,{size:"sm",variant:"ghost",onClick:f,disabled:u||!o.trim(),className:(0,l.cn)("h-7 px-2",x&&"text-green-500"),children:u?(0,s.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):(0,s.jsx)(ti.A,{className:"h-4 w-4"})})]})]})}function tF(e){let{children:t,onSelectTool:a,isAnalysisMode:n,activeTab:i,filters:o}=e,[d,c]=r.useState(null),[u,m]=r.useState(!1),x=(e,t)=>{t.preventDefault(),c(e),m(!0)},h=()=>{c(null),m(!1)};return n?(0,s.jsxs)(tA,{open:u,onOpenChange:m,children:[(0,s.jsx)(tR,{children:t}),(0,s.jsx)(tT,{className:(0,l.cn)(d&&"p-0"),onInteractOutside:e=>{d&&e.preventDefault()},onEscapeKeyDown:e=>{d&&e.preventDefault()},children:"comment"===d?(0,s.jsx)(tE,{onSave:e=>{a("comment",{content:e}),h()},onCancel:h,activeTab:i,filters:o}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(tO,{onSelect:e=>x("comment",e),children:[(0,s.jsx)(ty.A,{className:"mr-2 h-4 w-4"}),"Add Comment"]}),(0,s.jsxs)(tO,{onSelect:e=>x("highlight",e),children:[(0,s.jsx)(tD.A,{className:"mr-2 h-4 w-4"}),"Highlight + Comment"]}),(0,s.jsxs)(tO,{onSelect:e=>x("screenshot",e),children:[(0,s.jsx)(tz.A,{className:"mr-2 h-4 w-4"}),"Screenshot + Comment"]})]})})]}):(0,s.jsx)(s.Fragment,{children:t})}var tI=a(56870),tU=a(80790),tV=a(51055),tL=a(73580),tP=a(45686),tM=a(84267),tq=a(20750);function tB(e){let{open:t,onClose:a}=e,[n,i]=r.useState([]),[o,d]=r.useState(null),[u,m]=r.useState(""),x=r.useCallback(()=>{try{let e=JSON.parse(localStorage.getItem("analysis-comments")||"[]");i(e.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()))}catch(e){console.error("Erreur lors du chargement des commentaires:",e)}},[]);r.useEffect(()=>{t&&x()},[t,x]);let h=e=>{try{let t=n.filter(t=>t.id!==e);localStorage.setItem("analysis-comments",JSON.stringify(t)),i(t)}catch(e){console.error("Erreur lors de la suppression:",e)}},f=e=>{d(e.id),m(e.content)},p=e=>{try{let t=n.map(t=>t.id===e?{...t,content:u,timestamp:new Date().toISOString()}:t);localStorage.setItem("analysis-comments",JSON.stringify(t)),i(t),d(null)}catch(e){console.error("Erreur lors de la mise \xe0 jour:",e)}},v=e=>{var t,a;if(!e)return[];let s=[];return(null===(t=e.device_category)||void 0===t?void 0:t.length)&&s.push(...e.device_category.map(e=>"Device: ".concat(e))),(null===(a=e.item_category2)||void 0===a?void 0:a.length)&&s.push(...e.item_category2.map(e=>"Category: ".concat(e))),s};return(0,s.jsx)(tI.cj,{open:t,onOpenChange:e=>!e&&a(),children:(0,s.jsxs)(tI.h,{side:"right",className:"w-[400px] p-0 flex flex-col",children:[(0,s.jsx)("div",{className:"border-b p-6",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex-1 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Analysis Notes"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[n.length," note",1!==n.length?"s":""]})]}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:a,className:"h-9 w-9",children:(0,s.jsx)(g.A,{className:"h-4 w-4"})})]})})}),(0,s.jsx)(en.F,{className:"flex-1",children:(0,s.jsx)("div",{className:"p-6 space-y-6",children:n.map(e=>(0,s.jsxs)("div",{className:(0,l.cn)("p-4 rounded-lg border bg-card","transition-colors duration-200",o===e.id&&"ring-2 ring-primary"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(tU.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:e.tab})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleDateString()}),(0,s.jsxs)(tq.rI,{children:[(0,s.jsx)(tq.ty,{asChild:!0,children:(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,s.jsx)(tV.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(tq.SQ,{align:"end",children:[(0,s.jsxs)(tq._2,{onClick:()=>f(e),children:[(0,s.jsx)(tL.A,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,s.jsxs)(tq._2,{onClick:()=>h(e.id),className:"text-destructive",children:[(0,s.jsx)(tP.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]}),o===e.id?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.T,{value:u,onChange:e=>m(e.target.value),className:"min-h-[100px]"}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(c.$,{size:"sm",variant:"outline",onClick:()=>d(null),children:"Cancel"}),(0,s.jsx)(c.$,{size:"sm",onClick:()=>p(e.id),children:"Save"})]})]}):(0,s.jsx)("p",{className:"text-sm mb-3",children:e.content}),e.filters&&v(e.filters).length>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-3",children:[(0,s.jsx)(tM.A,{className:"h-3 w-3"}),(0,s.jsx)("div",{className:"flex gap-1 flex-wrap",children:v(e.filters).map(e=>(0,s.jsx)("span",{className:"bg-muted px-1.5 py-0.5 rounded",children:e},e))})]})]},e.id))})})]})})}function t$(e){let{testData:t,currency:a,filters:i,results:o,isCollapsed:d,onToolSelect:u,onChatToggle:m}=e,[x,h]=r.useState(null),[f,p]=r.useState(!1),[v,g]=r.useState(null),[j,b]=r.useState(!1),[N,y]=r.useState(!1),[w,k]=r.useState([]),[S,C]=r.useState("overview"),[_,A]=r.useState(!1),R=r.useMemo(()=>(0,s.jsx)(tN,{data:t,isLoading:f}),[t,f]),T=r.useMemo(()=>({overview:(0,s.jsx)("div",{className:"h-full overflow-auto relative",children:(0,s.jsx)(eF,{data:x,isLoading:f})}),engagement:(0,s.jsx)("div",{children:"Engagement content"}),funnel:(0,s.jsx)("div",{children:"Funnel content"}),revenue:(0,s.jsx)("div",{className:"h-full overflow-auto",children:R}),raw:(0,s.jsx)(eA,{data:t,currency:t.currency||a})}),[x,f,t,a,R]),O=r.useCallback(async()=>{try{var e,a,s,r;p(!0);let l={overall:(null==t?void 0:null===(a=t.analysisData)||void 0===a?void 0:null===(e=a.raw_data)||void 0===e?void 0:e.overall)||[],transaction:(null==t?void 0:null===(r=t.analysisData)||void 0===r?void 0:null===(s=r.raw_data)||void 0===s?void 0:s.transaction)||[]},n=await fetch("http://localhost:8000/calculate-overview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!n.ok)throw Error("Failed to fetch overview data");let i=await n.json();if(!i.success)throw Error("Invalid response format");h(i)}catch(e){}finally{p(!1)}},[t]);return r.useEffect(()=>{O()},[O]),r.useEffect(()=>{let e=()=>{try{let e=localStorage.getItem("analysis-comments");if(e){let t=JSON.parse(e);k(t)}}catch(e){console.error("Erreur lors du chargement des notes:",e),k([])}};return e(),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[j]),(0,s.jsxs)("div",{className:"h-full relative",children:[(0,s.jsx)(tF,{onSelectTool:u,isAnalysisMode:j,activeTab:S,filters:i,children:(0,s.jsxs)(n,{className:(0,l.cn)("h-full w-full","transition-all duration-300","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=open]:fade-in-0 data-[state=closed]:fade-out-0",j&&["relative","ring-1 ring-primary/50","before:absolute before:inset-0 before:rounded-lg before:bg-primary/5"]),children:[j&&(0,s.jsx)("div",{className:"absolute -top-5 right-4 z-10 bg-primary/10 text-primary px-3 py-1 rounded-t-lg text-xs font-medium border border-primary/20",children:"Analysis Mode"}),(0,s.jsxs)(ev,{value:S,onValueChange:C,className:(0,l.cn)("h-full flex flex-col","relative","overflow-hidden"),children:[(0,s.jsxs)("div",{className:(0,l.cn)("flex items-center justify-between border-b px-6 py-4 shrink-0","sticky top-0 bg-background z-10",j&&"bg-primary/5"),children:[(0,s.jsxs)(eg,{children:[(0,s.jsx)(ej,{value:"overview",children:"Overview"}),(0,s.jsx)(ej,{value:"engagement",children:"Engagement"}),(0,s.jsx)(ej,{value:"funnel",children:"Funnel"}),(0,s.jsx)(ej,{value:"revenue",children:"Revenue"}),(0,s.jsx)(ej,{value:"raw",children:"Raw"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(c.$,{variant:"ghost",size:"icon",onClick:()=>y(!0),className:"relative",children:[(0,s.jsx)(ty.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"absolute -top-1 -right-1 text-[10px] bg-primary text-primary-foreground w-4 h-4 flex items-center justify-center rounded-full",children:w.length})]}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:()=>{A(!_),m(!_)},className:(0,l.cn)("relative",_&&"bg-primary/10 hover:bg-primary/20"),children:(0,s.jsx)(tw.A,{className:(0,l.cn)("h-4 w-4",_&&"text-primary")})})]}),(0,s.jsx)("div",{className:"w-px h-4 bg-border mx-2"})]}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",onClick:()=>{let e=!j;b(e),e||(A(!1),m(!1))},className:(0,l.cn)("relative",j&&["bg-primary/10 hover:bg-primary/20"]),children:(0,s.jsx)(tk.A,{className:(0,l.cn)("h-4 w-4",j&&"text-primary")})})]})]}),(0,s.jsxs)("div",{className:"flex-1 relative overflow-auto content-area",children:[(0,s.jsx)(eb,{value:"overview",className:"p-6 absolute inset-0",children:T.overview}),(0,s.jsx)(eb,{value:"engagement",className:"p-6 absolute inset-0",children:T.engagement}),(0,s.jsx)(eb,{value:"funnel",className:"p-6 absolute inset-0",children:T.funnel}),(0,s.jsx)(eb,{value:"revenue",className:"p-6 absolute inset-0",children:T.revenue}),(0,s.jsx)(eb,{value:"raw",className:"absolute inset-0 overflow-hidden",children:T.raw})]})]})]})}),(0,s.jsx)(tB,{open:N,onClose:()=>y(!1)})]})}var tJ=a(63898),tW=a(14505),tK=a(28283),tZ=a(82651);function tH(e){let{className:t,onClose:a,testData:i}=e,[o,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(!1),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{d([{id:"0",content:"Je suis votre assistant d'analyse A/B, propuls\xe9 par Mistral-7B-v0.1. Je suis sp\xe9cialis\xe9 dans l'interpr\xe9tation des tests A/B, l'analyse statistique et l'optimisation de conversion. Je peux vous aider \xe0 comprendre vos r\xe9sultats de test, \xe9valuer la significativit\xe9 statistique et formuler des recommandations bas\xe9es sur les donn\xe9es.",role:"assistant",timestamp:new Date}])},[]),(0,r.useEffect)(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[o]);let p=(e,t)=>{let a=e.split(" ");for(;a.length>t;)a.pop();return a.join(" ")},v=async(e,t)=>{var a,s,r,l,n,i;try{let s="Tu es un assistant d'analyse A/B sp\xe9cialis\xe9, voici ton contexte et tes r\xe8gles :\n\n      CONTEXTE :\n      - Tu analyses des tests A/B pour optimiser des sites web et applications\n      - Voici les donn\xe9es fournies par l'utilisateur : ".concat(JSON.stringify(t),"\n      - Tu as acc\xe8s aux donn\xe9es de conversion, revenus, et comportement utilisateur\n      - Tu comprends les concepts de significativit\xe9 statistique et d'intervalles de confiance\n      - Tu peux interpr\xe9ter les m\xe9triques : taux de conversion, ARPU, AOV, etc.\n\n      COMPORTEMENT :\n      - Reste TOUJOURS concentr\xe9 sur l'analyse A/B et l'interpr\xe9tation des donn\xe9es\n      - Ne r\xe9ponds PAS aux questions hors sujet ou non li\xe9es \xe0 l'analyse A/B\n      - Pour les questions hors sujet, rappelle poliment que tu es sp\xe9cialis\xe9 en analyse A/B\n      - Sois pr\xe9cis et factuel dans tes analyses\n      - Utilise des pourcentages et des chiffres quand c'est pertinent\n      - Mentionne TOUJOURS la significativit\xe9 statistique dans tes analyses\n\n      STRUCTURE DE R\xc9PONSE :\n      1. Analyse des donn\xe9es/m\xe9triques pertinentes\n      2. \xc9valuation de la significativit\xe9 statistique\n      3. Interpr\xe9tation des r\xe9sultats\n      4. Recommandations concr\xe8tes\n      5. Suggestions pour approfondir l'analyse si n\xe9cessaire\n\n      Question : ").concat(e,"\n\n      R\xe9ponse (en gardant un ton professionnel et analytique) :"),r=s.split(" ").length,l=s;r+500>32768&&(l=p(s,32268));let n=await (0,tZ.A)({url:"https://api-inference.huggingface.co/models/mistralai/Mistral-7B-v0.1",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat("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")},data:{inputs:l,parameters:{max_new_tokens:500,temperature:.7,top_p:.95,do_sample:!0,return_full_text:!1,stop:["Question :","Human:","Assistant:"]}}});return null===(a=n.data[0])||void 0===a?void 0:a.generated_text.replace(/^\s*RÃ©ponse\s*:/,"").trim()}catch(e){if(tZ.A.isAxiosError(e)){let t=(null===(r=e.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.error)||e.message||"Erreur inconnue";throw console.error("Erreur API:",{status:null===(l=e.response)||void 0===l?void 0:l.status,statusText:null===(n=e.response)||void 0===n?void 0:n.statusText,data:null===(i=e.response)||void 0===i?void 0:i.data,message:t}),Error("Erreur de l'API Hugging Face: ".concat(t))}throw e}},g=async e=>{if(e.preventDefault(),!u.trim()||x)return;let t={id:Date.now().toString(),content:u,role:"user",timestamp:new Date};d(e=>[...e,t]),m(""),h(!0);try{let e=await v(u,i),t={id:(Date.now()+1).toString(),content:e,role:"assistant",timestamp:new Date};d(e=>[...e,t])}catch(t){console.error("Erreur:",t);let e={id:(Date.now()+1).toString(),content:"D\xe9sol\xe9, je rencontre des difficult\xe9s pour r\xe9pondre. Veuillez r\xe9essayer.",role:"assistant",timestamp:new Date};d(t=>[...t,e])}finally{h(!1)}};return(0,s.jsxs)(n,{className:(0,l.cn)("flex flex-col h-full","bg-background shadow-none border-none","overflow-hidden","relative z-40","animate-in slide-in-from-left duration-300",t),children:[(0,s.jsx)("div",{className:"flex-none px-6 py-2 bg-background/50"}),(0,s.jsxs)("div",{className:"flex-1 relative min-h-0",children:[(0,s.jsx)("div",{className:"sticky top-0 left-0 right-0 h-24 bg-gradient-to-b from-background via-background/80 to-transparent z-10 pointer-events-none"}),(0,s.jsx)("div",{className:"absolute inset-0",children:(0,s.jsx)("div",{ref:f,className:"h-full overflow-auto px-6",children:(0,s.jsx)("div",{className:"flex flex-col-reverse",children:(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[o.map(e=>(0,s.jsx)("div",{className:(0,l.cn)("flex","user"===e.role?"justify-end":"justify-start","animate-in fade-in-0 slide-in-from-bottom-2"),children:(0,s.jsxs)("div",{className:(0,l.cn)("flex items-start gap-3 max-w-[90%]","user"===e.role?"flex-row-reverse":"flex-row"),children:[(0,s.jsx)(tJ.eu,{className:(0,l.cn)("h-8 w-8 shrink-0","assistant"===e.role?"bg-muted/50":"bg-primary"),children:"assistant"===e.role&&(0,s.jsx)(tw.A,{className:"h-5 w-5 text-foreground/80"})}),(0,s.jsx)("div",{className:(0,l.cn)("flex-1 text-sm leading-relaxed whitespace-pre-wrap","rounded-lg px-4 py-3","user"===e.role?"bg-primary text-primary-foreground":"bg-muted/50 text-foreground/90"),children:e.content})]})},e.id)),x&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,s.jsx)(tW.A,{className:"h-4 w-4 animate-spin"}),(0,s.jsx)("span",{className:"text-sm",children:"Assistant est en train d'\xe9crire..."})]})]})})})})]}),(0,s.jsx)("div",{className:"flex-none p-4 bg-background",children:(0,s.jsx)("form",{onSubmit:g,className:"relative max-w-[720px] mx-auto",children:(0,s.jsxs)("div",{className:"relative flex items-end gap-2 p-[1px] bg-background rounded-lg border shadow-sm",children:[(0,s.jsx)(S.p,{value:u,onChange:e=>m(e.target.value),placeholder:"Posez votre question ici...",className:"flex-1"}),(0,s.jsx)(c.$,{type:"submit",className:"h-8 w-8 p-0",children:(0,s.jsx)(tK.A,{className:"h-4 w-4"})})]})})})]})}function tQ(){let[e,t]=(0,r.useState)(!1),[a,n]=(0,r.useState)("initial"),[i,o]=(0,r.useState)(null),[d,c]=(0,r.useState)("EUR"),[u,m]=(0,r.useState)({device_category:[],item_category2:[]}),[x,h]=(0,r.useState)(null),[f,p]=(0,r.useState)(null),[v,g]=(0,r.useState)(null),[j,b]=(0,r.useState)(!1),[N,y]=(0,r.useState)(null),[w,k]=(0,r.useState)({x:0,y:0}),[S,C]=(0,r.useState)(!1),[_,A]=(0,r.useState)(!1),R=async e=>{t(!0),o(e)};return(0,s.jsxs)("div",{className:"flex h-[calc(100vh-3rem)] max-w-[1600px] mx-auto p-6 relative gap-4",children:[(!_||!e)&&(0,s.jsx)("div",{className:(0,l.cn)("transition-all duration-300","analyzed"!==a||e?j?"w-[200px]":"w-[400px]":"w-full","shrink-0 h-full","animate-in slide-in-from-left"),children:(0,s.jsx)(ef,{onAnalysisStart:R,onProcessStepChange:n,showAnalysis:e,currency:d,onCurrencyChange:e=>{c(e)},filters:u,onFilterChange:(e,t)=>{m(a=>{let s=a[e],r=s.includes(t)?s.filter(e=>e!==t):[...s,t];return{...a,[e]:r}})},onCollapse:b})}),_&&e&&(0,s.jsx)("div",{className:(0,l.cn)("w-[400px] shrink-0","h-full","transition-all duration-300","animate-in slide-in-from-left","overflow-hidden"),children:(0,s.jsx)(tH,{testData:i,onClose:()=>A(!1),className:"h-full"})}),e&&(0,s.jsx)("div",{className:(0,l.cn)("flex-1 h-full","transition-all duration-300",j?"ml-0":"ml-6"),children:(0,s.jsx)(t$,{testData:i,currency:d,filters:u,results:v,isCollapsed:j,onToolSelect:(e,t)=>{y(e),k(t)},onChatToggle:A})})]})}},63898:(e,t,a)=>{"use strict";a.d(t,{BK:()=>o,eu:()=>i,q5:()=>d});var s=a(95155),r=a(12115),l=a(74920),n=a(29602);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...r})});i.displayName=l.bL.displayName;let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",a),...r})});o.displayName=l._V.displayName;let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...r})});d.displayName=l.H4.displayName},39286:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var s=a(95155);a(12115);var r=a(31027),l=a(29602);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,l.cn)(n({variant:a}),t),...r})}},14085:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>o});var s=a(95155),r=a(12115),l=a(12317),n=a(31027),i=a(29602);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:r,size:n,className:a})),ref:t,...c})});d.displayName="Button"},49019:(e,t,a)=>{"use strict";a.d(t,{Ke:()=>n,Nt:()=>r,R6:()=>l});var s=a(18369);let r=s.bL,l=s.R6,n=s.Ke},20750:(e,t,a)=>{"use strict";a.d(t,{I:()=>m,SQ:()=>x,_2:()=>h,lp:()=>f,mB:()=>p,rI:()=>c,ty:()=>u});var s=a(95155),r=a(12115),l=a(38130),n=a(46967),i=a(98867),o=a(33565),d=a(29602);let c=l.bL,u=l.l9,m=l.YJ;l.ZL,l.Pb,l.z6,r.forwardRef((e,t)=>{let{className:a,inset:r,children:i,...o}=e;return(0,s.jsxs)(l.ZP,{ref:t,className:(0,d.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...o,children:[i,(0,s.jsx)(n.A,{className:"ml-auto"})]})}).displayName=l.ZP.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.G5,{ref:t,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}).displayName=l.G5.displayName;let x=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsx)(l.UC,{ref:t,sideOffset:r,className:(0,d.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});x.displayName=l.UC.displayName;let h=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(l.q7,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",a),...n})});h.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,checked:n,...o}=e;return(0,s.jsxs)(l.H_,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})}),r]})}).displayName=l.H_.displayName,r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(l.hN,{ref:t,className:(0,d.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(o.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=l.hN.displayName;let f=r.forwardRef((e,t)=>{let{className:a,inset:r,...n}=e;return(0,s.jsx)(l.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",a),...n})});f.displayName=l.JU.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})});p.displayName=l.wv.displayName},9955:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(95155),r=a(12115),l=a(29602);let n=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});n.displayName="Input"},51124:(e,t,a)=>{"use strict";a.d(t,{AM:()=>i,Wv:()=>o,hl:()=>d});var s=a(95155),r=a(12115),l=a(80532),n=a(29602);let i=l.bL,o=l.l9,d=r.forwardRef((e,t)=>{let{className:a,align:r="center",sideOffset:i=4,...o}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsx)(l.UC,{ref:t,align:r,sideOffset:i,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});d.displayName=l.UC.displayName},3392:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,F:()=>i});var s=a(95155),r=a(12115),l=a(21868),n=a(29602);let i=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(l.bL,{ref:t,className:(0,n.cn)("relative overflow-hidden",a),...i,children:[(0,s.jsx)(l.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,s.jsx)(o,{}),(0,s.jsx)(l.OK,{})]})});i.displayName=l.bL.displayName;let o=r.forwardRef((e,t)=>{let{className:a,orientation:r="vertical",...i}=e;return(0,s.jsx)(l.VM,{ref:t,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,s.jsx)(l.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=l.VM.displayName},50745:(e,t,a)=>{"use strict";a.d(t,{bq:()=>m,eb:()=>p,gC:()=>f,l6:()=>c,yv:()=>u});var s=a(95155),r=a(12115),l=a(63409),n=a(51719),i=a(91902),o=a(98867),d=a(29602);let c=l.bL;l.YJ;let u=l.WT,m=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(l.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[r,(0,s.jsx)(l.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.l9.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=l.PP.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=l.wn.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,position:n="popper",...i}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsxs)(l.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,s.jsx)(x,{}),(0,s.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(h,{})]})})});f.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=l.JU.displayName;let p=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(l.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})}),(0,s.jsx)(l.p4,{children:r})]})});p.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=l.wv.displayName},56870:(e,t,a)=>{"use strict";a.d(t,{cj:()=>d,h:()=>x});var s=a(95155),r=a(12115),l=a(66217),n=a(31027),i=a(40767),o=a(29602);let d=l.bL;l.l9,l.bm;let c=l.ZL,u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});u.displayName=l.hJ.displayName;let m=(0,n.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=r.forwardRef((e,t)=>{let{side:a="right",className:r,children:n,...d}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(l.UC,{ref:t,className:(0,o.cn)(m({side:a}),r),...d,children:[n,(0,s.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold text-foreground",a),...r})}).displayName=l.hE.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})}).displayName=l.VY.displayName},25488:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(95155),r=a(29602);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...a})}},10371:(e,t,a)=>{"use strict";a.d(t,{T:()=>n});var s=a(95155),r=a(12115),l=a(29602);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});n.displayName="Textarea"},9246:(e,t,a)=>{"use strict";a.d(t,{TooltipProvider:()=>i,ZI:()=>c,k$:()=>d,m_:()=>o});var s=a(95155),r=a(12115),l=a(19710),n=a(29602);let i=l.Kq,o=l.bL,d=l.l9,c=r.forwardRef((e,t)=>{let{className:a,sideOffset:r=4,...i}=e;return(0,s.jsx)(l.UC,{ref:t,sideOffset:r,className:(0,n.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...i})});c.displayName=l.UC.displayName},65494:(e,t,a)=>{"use strict";a.d(t,{D6:()=>r,TU:()=>l,Vv:()=>s});let s={SECTION_TITLE:"COUNTRIES",STATUS_OPTIONS:[{label:"To be prioritized",value:"to_prioritize"},{label:"In progress",value:"in_progress"},{label:"Done",value:"done"}],MIN_EXPERIMENT_DAYS:30},r={primary:"hsl(243, 75%, 59%)",secondary:"hsl(162, 73%, 46%)",accent:"hsl(326, 100%, 74%)",yellow:"hsl(31, 95%, 64%)",blue:"hsl(190, 90%, 50%)",control:"hsl(230, 15%, 50%)"},l=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e===t)return r.control;let s=[r.primary,r.secondary,r.accent,r.yellow,r.blue];return s[a%s.length]}},29602:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(43463),r=a(69795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[428,976,592,898,441,517,358],()=>t(58247)),_N_E=e.O()}]);